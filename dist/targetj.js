(()=>{"use strict";var t={d:(e,i)=>{for(var n in i)t.o(i,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:i[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{$Dom:()=>s,App:()=>b,Bracket:()=>f,ColorUtil:()=>o,Easing:()=>l,Moves:()=>E,SearchUtil:()=>a,TModel:()=>c,TUtil:()=>r,TargetUtil:()=>u,browser:()=>n,getEvents:()=>M,getLoader:()=>L,getManager:()=>S,getPager:()=>w,getScreenHeight:()=>x,getScreenWidth:()=>D,isRunning:()=>C,tapp:()=>i,troot:()=>V});var i,n={style:void 0,delayProcess:{},setup:function(){if("function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(t){return 0===this.indexOf(t)}),"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(t){return-1!==this.indexOf(t,this.length-t.length)}),"function"!=typeof String.prototype.hashCode&&(String.prototype.hashCode=function(){var t,e,i=0;if(0===this.length)return i;for(t=0,e=this.length;t<e;t++)i=(i<<5)-i+this.charCodeAt(t),i|=0;return Math.abs(i)}),Array.prototype.oids||(Array.prototype.oids=function(t){return this.map((function(t){return t.oid})).join(t||" ")}),Array.spaces||(Array.spaces=function(t){return Array(t).join(" ")}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null===this)throw new TypeError('"this" is null or not defined');var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var n=arguments[1],a=0;a<i;){var r=e[a];if(t.call(n,r,a,e))return r;a++}},configurable:!0,writable:!0}),!document.getElementsByClassName){var t=[].indexOf||function(t){for(var e=0;e<this.length;e++)if(this[e]===t)return e;return-1},e=function(e,i){return document.querySelectorAll?i.querySelectorAll("."+e):function(){for(var n=i.getElementsByTagName("*"),a=[],r=0;r<n.length;r++)n[r].className&&(" "+n[r].className+" ").indexOf(" "+e+" ")>-1&&-1===t.call(a,n[r])&&a.push(n[r]);return a}()};document.getElementsByClassName=function(t){return e(t,document)},Element.prototype.getElementsByClassName=function(t){return e(t,this)}}for(var i=0,n=["ms","moz","webkit","o"],a=0;a<n.length&&!window.requestAnimationFrame;++a)window.requestAnimationFrame=window[n[a]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n[a]+"CancelAnimationFrame"]||window[n[a]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,e){var n=(new Date).getTime(),a=Math.max(0,16-(n-i)),r=window.setTimeout((function(){t(n+a)}),a);return i=n+a,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)}),this.style={transform:this.prefixStyle("transform"),transitionTimingFunction:this.prefixStyle("transitionTimingFunction"),transitionDuration:this.prefixStyle("transitionDuration")}},log:function(t){return!0===t?console.log:function(){}},prefixStyle:function(t){for(var e=document.createElement("div").style,i="",n=["webkitT","MozT","msT","OT","t"],a=0;a<n.length;a++)n[a]+"ransform"in e&&(i=n[a].substr(0,n[a].length-1));return""===i?t:i+t.charAt(0).toUpperCase()+t.substr(1)},getParameterByName:function(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var e=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search);return null===e?0:decodeURIComponent(e[1].replace(/\+/g," "))},now:Date.now||function(){return(new Date).getTime()},nowInSeconds:function(){return Math.floor(this.now()/1e3)},delay:function(t,e,i){var a,r=n.now()+i;return this.delayProcess.id?r>=this.delayProcess.timeStamp?a={timeStamp:r,oid:e,delay:i}:r<this.delayProcess.timeStamp&&(a={timeStamp:this.delayProcess.timeStamp,oid:this.delayProcess.oid,delay:this.delayProcess.delay},clearTimeout(this.delayProcess.id),this.delayProcess.oid=e,this.delayProcess.timeStamp=r,this.delayProcess.delay=i,this.delayProcess.id=setTimeout((function(){t(),n.delayProcess={}}),i)):(this.delayProcess.oid=e,this.delayProcess.timeStamp=r,this.delayProcess.delay=i,this.delayProcess.id=setTimeout((function(){t(),n.delayProcess={}}),i)),a}};function a(){}function r(){}function s(t){"string"==typeof t?(this.selector=t,this.element=s.query(t)):t&&(this.element=t),this.childrenCount=0,this.$domParent=void 0,this.originalContent=void 0,this.textOnly=!0}function o(){}function l(){}function u(){}function h(){}function d(t){this.tmodel=t,this.xNext=0,this.xNorth=0,this.xWest=0,this.xEast=0,this.xSouth=0,this.xOverflow=0,this.xOffset=0,this.yNext=0,this.yNorth=0,this.yWest=0,this.yEast=0,this.ySouth=0,this.yOffset=0,this.reset()}function c(t,e){1===arguments.length&&"object"==typeof t&&(e=t,t=""),this.type=t||"blank",this.targets=Object.assign({},e),this.activeTargetList=[],this.activeTargetMap={};var i=b.getOid(this.type);this.oid=i.oid,this.oidNum=i.num,this.targetValues={},this.actualValues={x:0,y:0,width:0,height:0,leftMargin:0,rightMargin:0,topMargin:0,bottomMargin:0,innerWidth:void 0,innerHeight:void 0,opacity:1,zIndex:1,scale:1,rotate:0,scrollLeft:0,scrollTop:0,textOnly:!0,html:void 0,css:"",style:null,borderRadius:0,children:[],addedChildren:[],allChildren:[],isInFlow:!0,canHaveDom:!0,canHandleEvents:!1,widthFromDom:!1,heightFromDom:!1,keepEventDefault:!1,isIncluded:!0,canBeBracketed:!0,isDomDeletable:!0,calculateChildren:void 0,isVisible:void 0,onResize:void 0,onTouchEvent:void 0,onScrollEvent:void 0,onKeyEvent:void 0},this.updatingTargetList=[],this.updatingTargetMap={},this.styleTargetList=[],this.styleTargetMap={},this.updatingChildrenList=[],this.updatingChildrenMap={},this.targetMethodMap={},this.parent=null,this.$dom=null,this.visibilityStatus={top:!1,right:!1,bottom:!1,left:!1},this.visible=!1,this.domHeight=void 0,this.domWidth=void 0,this.innerContentWidth=0,this.innerContentHeight=0,this.contentWidth=0,this.contentHeight=0,this.x=0,this.y=0,this.absX=0,this.absY=0,this.inFlowVisibles=[],this.domValues={},this.initTargets()}function g(){this.currentTouch={deltaY:0,deltaX:0,pinchDelta:0,key:"",manualMomentumFlag:!1,orientation:"none",dir:"",source:""},this.touchTimeStamp=0,this.cursor={x:0,y:0},this.start0=void 0,this.start1=void 0,this.end0=void 0,this.end1=void 0,this.touchCount=0,this.currentEvent="",this.currentHandlers={touch:null,scrollLeft:null,scrollTop:null,pinch:null},this.eventQueue=[],this.eventMap={touchstart:{to:"touchstart",inputType:"touch",eventType:"start",order:1,windowEvent:!1},touchmove:{to:"touchmove",inputType:"touch",eventType:"move",order:1,windowEvent:!1},touchend:{to:"touchend",inputType:"touch",eventType:"end",order:1,windowEvent:!1},touchcancel:{to:"touchend",inputType:"touch",eventType:"cancel",order:1,windowEvent:!1},mousedown:{to:"mousedown",inputType:"mouse",eventType:"start",order:2,windowEvent:!1},mousemove:{to:"mousemove",inputType:"mouse",eventType:"move",order:2,windowEvent:!1},mouseup:{to:"mouseup",inputType:"mouse",eventType:"end",order:2,windowEvent:!1},mousecancel:{to:"mouseup",inputType:"mouse",eventType:"cancel",order:2,windowEvent:!1},pointerdown:{to:"mousedown",inputType:"pointer",eventType:"start",order:3,windowEvent:!1},pointermove:{to:"mousemove",inputType:"pointer",eventType:"move",order:3,windowEvent:!1},pointerup:{to:"mouseup",inputType:"pointer",eventType:"end",order:3,windowEvent:!1},pointercancel:{to:"mousecancel",inputType:"pointer",eventType:"cancel",order:3,windowEvent:!1},wheel:{to:"wheel",inputType:"",eventType:"wheel",order:1,windowEvent:!1},DOMMouseScroll:{to:"wheel",inputType:"",eventType:"wheel",order:1,windowEvent:!1},mousewheel:{to:"wheel",inputType:"",eventType:"wheel",order:1,windowEvent:!1},keyup:{to:"key",inputType:"",eventType:"key",order:1,windowEvent:!0},keydown:{to:"key",inputType:"",eventType:"key",order:1,windowEvent:!0},resize:{to:"resize",inputType:"",eventType:"resize",order:1,windowEvent:!0},orientationchange:{to:"resize",inputType:"",eventType:"resize",order:1,windowEvent:!0}};var t=this;this.domEvents=Object.keys(this.eventMap).filter((function(e){return!1===t.eventMap[e].windowEvent})),this.windowEvents=Object.keys(this.eventMap).filter((function(e){return t.eventMap[e].windowEvent})),this.bindedHandleEvent=this.bindedHandleEvent?this.bindedHandleEvent:this.handleEvent.bind(this)}function p(){this.resultMap={},this.loadingMap={},this.singleLoadList=void 0,this.groupLoadList=void 0,this.imgLoadList=void 0,this.stopLoadingAfterAttempts=r.isDefined(i.stopLoadingAfterAttempts)?i.stopLoadingAfterAttempts:10,this.attemptFailedInterval=r.isDefined(i.attemptFailedInterval)?i.attemptFailedInterval:2e3,this.statistics={}}function f(t){var e=new c("BI",{canHaveDom:!1,outerXEast:0});return e.parent=t,e.newFlag=!0,e.getWidth=function(){return this.getContentWidth()},e.getHeight=function(){return this.getContentHeight()},e.getInnerWidth=function(){return this.innerContentWidth},e.getInnerXEast=function(){return r.isDefined(e.getRealParent().val("innerXEast"))?this.getRealParent().val("innerXEast"):this.getRealParent().absX+this.getRealParent().getWidth()},e.getInnerContentHeight=function(){return this.innerContentHeight},e.getScrollTop=function(){return this.initParents(),this.getRealParent().getScrollTop()},e.getScrollLeft=function(){return this.initParents(),this.getRealParent().getScrollLeft()},e.getBoundingRect=function(){return this.initParents(),r.getBoundingRect(this.getRealParent())},e.calculateAbsolutePosition=function(t,e){var i=this.getBoundingRect();this.absX=i.left+t,this.absY=i.top+e},e.isVisible=function(){return this.visibilityStatus.top&&this.visibilityStatus.bottom},e.addToUpdatingChildren=function(t){this.getRealParent().addToUpdatingChildren(t)},e.createViewport=function(){return this.getRealParent().createViewport.call(this)},e.getRealParent=function(){return this.initParents(),this.realParent},e.shouldCalculateChildren=function(){var t=this.isVisible()||this.newFlag;return this.newFlag=!1,t},e.getChildren=function(){return this.actualValues.tchildren},e.addToParentVisibleList=function(){},e.initParents=function(){if(!this.realParent&&!this.topBracket){for(var t=this,e=this.bracketParent;e&&"BI"===e.type;)t=e,e=e.bracketParent;this.realParent=e,this.topBracket=t}},e.getChildrenOids=function(){for(var t=[],e=this.getChildren(),i=0;i<e.length;i++){var n=e[i];if("BI"===n.type){var a=n.getChildrenOids();t=[].concat(t,[n.oid],a)}else t.push(n.oid+":"+n.getHeight())}return t},e}function m(){this.hasLocationList=[],this.hasLocationMap={},this.bracketThreshold=6,this.locationCount=[],this.screenWidth=D(),this.screenHeight=x(),this.resizeFlag=!1}function y(){this.lastLink=document.URL,this.pageCache={}}function v(){this.init()}function T(){}function b(t){return(i=function(t){function e(){}return e.throttle=0,e.debugLevel=0,e.runningFlag=!1,e.init=function(){return n.setup(),e.$window=new s(window),e.$window.addEvent("popstate",(function(t){t.state&&i.pager.openLinkFromHistory(t.state)})),e.loader=new p,e.pager=new y,e.dim=function(){function t(){}return t.screen={x:0,y:0,width:0,height:0},t.measureScreen=function(){return t.screen.width=document.documentElement.clientWidth||document.body.clientWidth,t.screen.height=document.documentElement.clientHeight||document.body.clientHeight,t},t}().measureScreen(),e.events=new g,e.locationManager=new m,e.targetManager=new T,e.manager=new v,e.trootFactory=function(){var t=new c("targetj");return t.addChild=function(i,n){r.isDefined(i.targets.domHolder)||i.addTarget("domHolder",{value:function(){var t;return s.query("#tj-root")?t=new s("#tj-root"):((t=new s).create("div"),t.setSelector("#tj-root"),t.setId("#tj-root"),t.attr("tabindex","0"),new s("body").insertFirst$Dom(t)),t}}),r.isDefined(i.targets.addEventHandler)||i.addTarget("addEventHandler",{value:function(){e.events.removeHandlers(this.$dom),e.events.addHandlers(this.$dom),this.hasDom&&this.$dom.focus()},enabledOn:function(){return this.hasDom()}}),c.prototype.addChild.call(t,i,n)},e.troot&&e.troot.getChildren().forEach((function(e,i){var n=new c(e.type,e.targets);n.oidNum=i,n.oid=i>0?e.type+i:e.type,t.addChild(n)})),t},e.troot=e.trootFactory(),t&&e.troot.addChild(t),window.history.pushState({link:document.URL},"",document.URL),e},e.start=function(){return e.runningFlag=!1,e.events.clearAll(),e.troot.getChildren().forEach((function(t){t.deleteTargetValue("addEventHandler")})),e.events.removeWindowHandlers(),e.events.addWindowHandlers(),e.dim.measureScreen(),e.manager.resetRuns(),e.runningFlag=!0,e.manager.scheduleRun(0,"appStart"),e},e.stop=function(){return e.runningFlag=!1,e.events.removeWindowHandlers(),e.troot.getChildren().forEach((function(t){t.hasDom()&&e.events.removeHandlers(t.$dom)})),e.events.clearAll(),e.manager.resetRuns(),e},e.reset=function(){e.manager.lists.visible.forEach((function(t){t.domValues={}})),e.manager.clear(),e.locationManager.hasLocationList.length=0,e.locationManager.screenWidth=0,e.locationManager.screenHeight=0,a.foundParentWithTarget={},a.foundTypeMap={},a.foundTargetMap={}},e.isRunning=function(){return e.runningFlag},e.find=function(t){return a.find(t)},e}(t)).init().start(),i}function C(){return!!i&&i.runningFlag}function V(){return i?i.troot:null}function M(){return i?i.events:null}function w(){return i?i.pager:null}function L(){return i?i.loader:null}function S(){return i?i.manager:null}function D(){return i?i.dim.screen.width:0}function x(){return i?i.dim.screen.height:0}function E(){}a.foundParentWithType={},a.foundParentWithTarget={},a.foundTypeMap={},a.foundTargetMap={},a.foundOids={},a.findFirstPinchHandler=function(t){return a.findEventHandler(t,"pinch")},a.findFirstScrollTopHandler=function(t){return a.findEventHandler(t,"scrollTop")},a.findFirstScrollLeftHandler=function(t){return a.findEventHandler(t,"scrollLeft")},a.findFirstTouchHandler=function(t){return a.findEventHandler(t,"touch")},a.findEventHandler=function(t,e){for(;t;){if(!0===t.canHandleEvents()||t.canHandleEvents()===e||Array.isArray(t.canHandleEvents())&&t.canHandleEvents().includes(e))return t;t=t.getParent()}},a.findParentByType=function(t,e){var i,n=t.oid+"__"+e;return r.isDefined(a.foundParentWithType[n])||(function(){for(i=t.getParent();i&&i.type!==e;)i=i.getParent()}(),i&&(a.foundParentWithType[n]=i)),a.foundParentWithType[n]},a.findParentByTarget=function(t,e){var i,n=t.oid+"__"+e;return r.isDefined(a.foundParentWithTarget[n])||(function(){for(i=t.getParent();i&&!r.isDefined(i.targets[e])&&!r.isDefined(i.targetValues[e]);)i=i.getParent()}(),i&&(a.foundParentWithTarget[n]=i)),a.foundParentWithTarget[n]},a.findByType=function(t){var e;return r.isDefined(a.foundTypeMap[t])||(e=function i(n){if(n.type===t)return n;for(var a,r=n.getChildren(),s=0;r&&s<r.length&&!a;s++)(e=r[s])&&(e.hasChildren()?a=i(e):e.type===t&&(a=e));return a}(i.troot))&&(a.foundTypeMap[t]=e),a.foundTypeMap[t]},a.findByTarget=function(t){var e;return r.isDefined(a.foundTargetMap[t])||(e=function i(n){if(n.targets[t])return n;for(var a,r=n.getChildren(),s=0;r&&s<r.length&&!a;s++)(e=r[s])&&(e.hasChildren()?a=i(e):e.targets[t]&&(a=e));return a}(i.troot))&&(a.foundTargetMap[t]=e),a.foundTargetMap[t]},a.find=function(t){var e;return r.isDefined(a.foundOids[t])||(e=function i(n){if(n.oid===t)return n;for(var a,r=n.getChildren(),s=0;r&&s<r.length&&!a;s++)(e=r[s])&&(e.hasChildren()?a=i(e):e.oid===t&&(a=e));return a}(i.troot))&&(a.foundOids[t]=e),a.foundOids[t]},r.getBoundingRect=function(t){var e,i,n,r,s;if(t.actualValues.domHolder&&t.actualValues.domHolder.exists()){var o=t.actualValues.domHolder.getBoundingClientRect();e=o.left,i=o.top,n=o.right,r=o.bottom,s=t.actualValues.domHolder.attr("id")}else{var l=t.getDomParent()?t.getDomParent():a.findParentByTarget(t,"domHolder");l?(e=l.absX,i=l.absY,n=e+l.getWidth(),r=i+l.getHeight(),s=l.oid):(e=0,i=0,n=D(),r=x(),s="screen")}return{left:e,top:i,right:n,bottom:r,oid:s}},r.initDoms=function(t){var e=s.findByClass("tgt");t.forEach((function(t){t.$dom=null}));for(var i=r.list2map(t.filter((function(t){return"BI"!==t.type}))),n=0;n<e.length;n++){var a=e[n],o=a.getAttribute("id"),l=i[o];l&&!l.hasDom()?l.$dom=new s("#"+o):s.detach(a)}},r.list2map=function(t,e){return t.reduce((function(t,i){return t[i.oid]=r.isDefined(e)?e:i,t}),{})},r.getDeepList=function(t){var e=[];return function t(i){if(i&&i.hasChildren()){var n=i.getChildren();e=e.concat(n),n.forEach((function(e){t(e)}))}}(t),e},r.areEqual=function(t,e,i){return i?JSON.stringify(t)===JSON.stringify(e):t===e},r.momentum=function(t,e,i){i=i||1;var n=e-t,a=Math.abs(n)/i,r=Math.floor(5e3*a),s=5*r,o=n>0?n+s:n-s;return{distance:Math.round(o)/50,duration:r,momentumDistance:i,time:5*i}},r.isDefined=function(t){return null!=t},r.isNumber=function(t){return"number"==typeof t&&!isNaN(t)},r.limit=function(t,e,i){return(t=(t=r.isDefined(t)?t:e)>i?i:t)<e?e:t},r.formatNum=function(t,e){if(!t)return 0;var i=t.toString();return parseFloat(i).toFixed(e)},r.distance=function(t,e,i,n){return Math.sqrt((i-t)*(i-t)+(n-e)*(n-e))},r.getFullLink=function(t){if(r.isDefined(t)){if(0===t.indexOf("http"))return t;var e=window.location.protocol,i=(e+=e.endsWith(":")?"//":"://")+window.location.hostname;return t.startsWith("/")?i+t:i+"/"+t}},s.prototype.exists=function(){return this.selector&&(this.element=s.query(this.selector)),!!this.element},s.prototype.create=function(t){this.element=document.createElement(t)},s.prototype.setSelector=function(t){this.selector=t},s.prototype.setId=function(t){this.attr("id","#"===t[0]?t.slice(1):t)},s.prototype.focus=function(){this.element.focus()},s.prototype.attr=function(t,e){if(this.element)return r.isDefined(e)?void this.element.setAttribute(t,e):this.element.getAttribute(t)},s.prototype.value=function(t){if(this.element)return r.isDefined(t)?void(this.element.value=t):this.element.value},s.prototype.select=function(){this.element&&"function"==typeof this.element.select&&this.element.select()},s.prototype.width=function(t){if(!r.isDefined(t))return this.element.offsetWidth;this.element.style.width=r.isNumber(t)?t+"px":t},s.prototype.height=function(t){if(!r.isDefined(t))return this.element.offsetHeight;this.element.style.height=r.isNumber(t)?t+"px":t},s.prototype.css=function(t){if(!r.isDefined(t))return this.attr("classs");this.attr("class",t)},s.prototype.setStyleByMap=function(t){var e=this;Object.keys(t).forEach((function(i){var n=t[i];switch(i){case"transform":e.transform.apply(e,n);break;case"width":e.width(n);break;case"height":e.height(n);break;default:e.style(i,n)}}))},s.prototype.style=function(t,e){if(!r.isDefined(e))return this.element.style[t];this.element.style[t]=e},s.prototype.getStyleValue=function(t){var e=this.style(t),i=r.isDefined(e)?e.replace(/[^-\d.]/g,""):0;return parseFloat(i)},s.prototype.getBoundingClientRect=function(){return this.element.getBoundingClientRect()},s.prototype.parent=function(){return this.element?this.element.parentElement:null},s.prototype.detach=function(){s.detach(this.element),this.$domParent&&this.$domParent.childrenCount>0&&this.$domParent.childrenCount--},s.prototype.append$Dom=function(t){this.element.appendChild(t.element)},s.prototype.insertFirst$Dom=function(t){this.element.firstChild?this.element.insertBefore(t.element,this.element.firstChild):this.append$Dom(t)},s.prototype.appendTModel$Dom=function(t){0===this.childrenCount&&this.element.children.length>1&&t.getDomParent()&&t.getDomParent().getHtml()&&t.getDomParent().getHtml()===this.originalContent&&(this.element.innerHTML="<div>"+this.html()+"</div>"),this.element.appendChild(t.$dom.element),t.$dom.$domParent=this,this.childrenCount++},s.prototype.html=function(t){if(!r.isDefined(t))return this.originalContent;if(this.childrenCount>0){var e=document.createElement("div");e.innerHTML=t,r.isDefined(this.originalContent)?this.element.replaceChild(e,this.element.firstChild):this.element.insertBefore(e,this.element.firstChild),this.originalContent=t,this.textOnly=!1}else this.element.innerHTML=t,this.originalContent=t,this.textOnly=!1},s.prototype.text=function(t){if(!r.isDefined(t))return this.originalContent;if(this.childrenCount>0){var e=document.createTextNode(t);r.isDefined(this.originalContent)?this.element.replaceChild(e,this.element.firstChild):this.element.insertBefore(e,this.element.firstChild),this.originalContent=t,this.textOnly=!0}else this.element.textContent=t,this.originalContent=t,this.textOnly=!0},s.prototype.outerHTML=function(t){this.element.outerHTML=t},s.prototype.innerHTML=function(t){if(!r.isDefined(t))return this.element.innerHTML;this.element.innerHTML=t},s.prototype.addClass=function(t){var e=this.attr("class"),i=e?e.indexOf(t)>=0?e:e+" "+t:t;i!==e&&this.attr("class",i)},s.prototype.addEvent=function(t,e){this.element.addEventListener?this.element.addEventListener(t,e,{capture:!1,passive:!1}):this.element.attachEvent("on"+t,e)},s.prototype.detachEvent=function(t,e){this.element.removeEventListener?this.element.removeEventListener(t,e,!1):this.element.detachEvent?this.element.detachEvent("on"+t,e):this.element["on"+t]=null},s.prototype.transform=function(t,e,i,a){var r=this.createTrasformValue(t,e,i,a);r!==this.element.style[n.style.transform]&&(this.element.style[n.style.transform]=r)},s.prototype.createTrasformValue=function(t,e,i,n){return((r.isDefined(t)&&r.isDefined(e)?"translate("+(0!==t?t+"px":"0")+","+(0!==e?e+"px":"0")+") ":"")+(i=r.isDefined(i)?"rotate("+i+"deg) ":"")+(n=r.isDefined(n)?"scale("+n+")":"")).trim()},s.prototype.animate=function(t,e){return this.element.animate(t,e)},s.prototype.getContext=function(t,e){var i=r.isDefined(e)?s.query(e):this.query("canvas");return i?i.getContext(t):void 0},s.prototype.findFirstByClass=function(t){return s.findFirstByClass(t,this.element)},s.prototype.findFirstByTag=function(t){return s.findFirstByTag(t,this.element)},s.prototype.query=function(t){return"#"===t[0]?s.findById(t):"."===t[0]?this.findFirstByClass(t):this.findFirstByTag(t)},s.query=function(t){return"#"===t[0]?s.findById(t):"."===t[0]?s.findFirstByClass(t):s.findFirstByTag(t)},s.findById=function(t){return document.getElementById("#"===t[0]?t.slice(1):t)},s.findFirstByClass=function(t,e){var i=s.findByClass(t,e);return i.length>0?i[0]:null},s.findFirstByTag=function(t,e){var i=s.findByTag(t,e);return i.length>0?i[0]:null},s.findByTag=function(t,e){return(e=r.isDefined(e)?e:document).getElementsByTagName(t)},s.findByClass=function(t,e){return(e=r.isDefined(e)?e:document).getElementsByClassName("."===t[0]?t.slice(1):t)},s.findNearestParentWithId=function(t){for(;t;){var e="function"==typeof t.getAttribute&&t.getAttribute("id")?t.getAttribute("id"):null;if(e&&S().visibleOidMap[e])return e;t=t.parentElement}},s.detach=function(t){var e=r.isDefined(t)?t.parentElement:null;e&&e.removeChild(t)},s.ready=function(t){new s(document).addEvent("DOMContentLoaded",t)},s.ajax=function(t){var e=new XMLHttpRequest,i="";t.data&&(i=Object.keys(t.data).map((function(e){return e+"="+encodeURIComponent(t.data[e])})).join("&")),e.onreadystatechange=function(){if(4===e.readyState)if(200===e.status){var i="json"===t.dataType?JSON.parse(this.responseText):this.responseText;t.success(i)}else t.error(e.status)},"POST"===t.type?(e.open(t.type,t.url,!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.send(i)):(t.url+=i?t.url>""&&t.url.indexOf("?")>=0?"&"+i:"?"+i:"",e.open(t.type,t.url,!0),e.send())},o.colors={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},o.color2Integers=function(t){if(t=t?t+"":"",t=o.colors[t.toLowerCase()]?o.colors[t.toLowerCase()]:t){if(t.startsWith("#")){t=3===(t=t.slice(1)).length?t=t.split("").map((function(t){return t+t})).join(""):t;var e=parseInt(t,16);return[e>>16&255,e>>8&255,255&e]}var i=t.match(/\d+/g);return i&&3===i.length?i.map(Number):void 0}},l.linear=function(t){return t},l.inQuad=function(t){return t*t},l.outQuad=function(t){return t*(2-t)},l.outExpo=function(t){return 1-(1-t)*(1-t)},l.circular=function(t){return Math.sqrt(1- --t*t)},l.inOutQuad=function(t){return t<.5?2*t*t:(4-2*t)*t-1},l.inOut=function(t){return t<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2},l.outElastic=function(t){var e=2*Math.PI/3;return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin((10*t-.75)*e)+1},u.styleTargetMap={x:!0,y:!0,width:!0,height:!0,rotate:!0,scale:!0,opacity:!0,zIndex:!0,fontSize:!0,lineHeight:!0,borderRadius:!0,padding:!0,backgroundColor:!0,background:!0,color:!0,css:!0,style:!0,transform:!0,dim:!0},u.transformMap={x:!0,y:!0,rotate:!0,scale:!0},u.dimMap={width:!0,height:!0},u.colorMap={color:!0,background:!0,backgroundColor:!0},u.emptyValue=function(){return{value:void 0,step:0,steps:0,cycle:0,cycles:0,interval:0,initialValue:void 0,scheduleTimeStamp:void 0,actualValueLastUpdate:0,status:"",executionCount:0,isImperative:!1,originalTargetName:void 0,easing:void 0,creationTime:n.now()}},u.bindTargetName=function(t,e){var i=t[e];if("object"==typeof i)["value","enabledOn","onStepsEnd","onValueChange","loop","onImperativeEnd","onImperativeStep"].forEach((function(t){if("function"==typeof i[t]){var n=i[t];i[t]=function(){return this.key=e,n.apply(this,arguments)}}}));else if("function"==typeof i){var n=i;t[e]=function(){return this.key=e,n.apply(this,arguments)}}},u.isValueStepsCycleArray=function(t){if(t.length>4||0===t.length)return!1;for(var e=t.length>=2,i=1;i<t.length;i++)"number"!=typeof t[i]&&(e=!1);return!(!e||"number"!=typeof t[0]&&!u.isListTarget(t[0])&&"string"!=typeof t[0])},u.isListTarget=function(t){return"object"==typeof t&&Array.isArray(t.list)},u.isAddChildTarget=function(t,e){return e instanceof c&&"addChild"===t},u.getValueStepsCycles=function(t,e){var i=t.targets[e],n=!(!i||!i.valueOnly),a=t.getTargetCycle(e),s=t.val(e),o=null,l=0,h=0,d=0;return function c(g){return Array.isArray(g)?n||!u.isValueStepsCycleArray(g)?[g,l,h,d]:Array.isArray(i)?i:(o=g[0],l=g.length>=2?g[1]:l,h=g.length>=3?g[2]:h,d=g.length>=4?g[3]:d,[o,l,h,d]):"object"==typeof g&&null!==g?(o="function"==typeof g.value?g.value.call(t,a,s):r.isDefined(g.value)?g.value:g,l="function"==typeof g.steps?g.steps.call(t,a):r.isDefined(g.steps)?g.steps:0,h="function"==typeof g.interval?g.interval.call(t,a):r.isDefined(g.interval)?g.interval:0,d="function"==typeof g.cycles?g.cycles.call(t,a,t.getTargetCycles(e)):r.isDefined(g.cycles)?g.cycles:0,Array.isArray(o)?c(o):[o,l,h,d]):"function"==typeof g?c(g.call(t,a,s)):[g,l,h,d]}(i)},u.getIntervalValue=function(t,e,i){var n="function"==typeof i?i.call(t,e):i;return r.isNumber(n)?n:0},u.scheduleExecution=function(t,e){var i=n.now(),a=t.getTargetInterval(e),s=t.getScheduleTimeStamp(e),o=0;if(a>0)if(r.isDefined(s)){var l=i-s;o=Math.max(a-l,0)}else o=a,t.setScheduleTimeStamp(e,i);return o>0&&!r.isDefined(s)&&t.setScheduleTimeStamp(e,i),o},u.getTargetSchedulePeriod=function(t,e,i){var a,s=n.now(),o=0;return i>0?r.isDefined(t.getTargetTimeStamp(e))?o=(a=s-t.getTargetTimeStamp(e))<i?i-a:0:(t.setTargetTimeStamp(e,s),o=i):r.isDefined(t.getTargetTimeStamp(e))&&(o=(a=s-t.getTargetTimeStamp(e))<0?-a:0),o},u.handleValueChange=function(t,e,i,n,a,s){"object"==typeof t.targets[e]&&"function"==typeof t.targets[e].onValueChange&&!r.areEqual(i,n,t.targets[e].deepEquality)&&(t.targets[e].onValueChange.call(t,i,n,s),t.setTargetMethodName(e,"onValueChange"))},u.morph=function(t,e,i,n,a,r){var s=t.getTargetEasing(e),l=s?s(t.getTargetStepPercent(e,a)):t.getTargetStepPercent(e,a);if(u.colorMap[e]){var h=o.color2Integers(n),d=i?o.color2Integers(i):o.color2Integers("#fff");return h&&d?"rgb("+Math.floor(h[0]*l+d[0]*(1-l))+","+Math.floor(h[1]*l+d[1]*(1-l))+","+Math.floor(h[2]*l+d[2]*(1-l))+")":n}return"number"==typeof n?n*l+i*(1-l):n},u.setWidthFromDom=function(t){var e=r.isDefined(t.domWidth)?t.domWidth.height:void 0,i=r.isDefined(t.domWidth)?t.domWidth.width:void 0,n=t.getDomParent(),a=!1;return S().needsRerender(t)&&(t.isTextOnly()?t.$dom.text(t.getHtml()):t.$dom.html(t.getHtml()),a=!0),(!r.isDefined(t.domWidth)||a||e!==t.getHeight()||n&&t.getActualValueLastUpdate("width")<=n.getActualValueLastUpdate("width"))&&(t.$dom.width("auto"),i=t.$dom.width(),e=t.$dom.height()),t.domWidth={width:i,height:e},t.val("width",i),i},u.setHeightFromDom=function(t){var e=r.isDefined(t.domHeight)?t.domHeight.height:void 0,i=r.isDefined(t.domHeight)?t.domHeight.width:void 0,n=t.getDomParent(),a=!1;return S().needsRerender(t)&&(t.isTextOnly()?t.$dom.text(t.getHtml()):t.$dom.html(t.getHtml()),a=!0),(!r.isDefined(t.domHeight)||a||i!==t.getWidth()||n&&t.getActualValueLastUpdate("height")<=n.getActualValueLastUpdate("height"))&&(t.$dom.height("auto"),i=t.$dom.width(),e=t.$dom.height()),t.domHeight={height:e,width:i},t.val("height",e),e},h.executeDeclarativeTarget=function(t,e){h.resolveTargetValue(t,e),h.updateTarget(t,t.targetValues[e],e)},h.executeImperativeTarget=function(t,e,i,n,a,r,s){t.targetValues[e]=t.targetValues[e]||u.emptyValue();var o=t.targetValues[e];o.isImperative=!0,o.originalTargetName=s,u.isAddChildTarget(e,i)?t.addChild(i):u.isListTarget(i)?h.assignListTarget(o,i.list,i.list[0],n,a,r):(h.assignSingleTarget(o,i,void 0,n,0,a,r),o.step=0),h.updateTarget(t,o,e)},h.updateTarget=function(t,e,i){e.executionCount++,t.addToStyleTargetList(i),t.setTargetMethodName(i,"value"),0===t.getTargetSteps(i)&&h.snapActualToTarget(t,i),t.updateTargetStatus(i)},h.assignListTarget=function(t,e,i,n,a,s){t.valueList=e,t.stepList=Array.isArray(n)?n:r.isDefined(n)?[n]:[1],t.intervalList=Array.isArray(a)?a:r.isDefined(a)?[a]:[0],t.easingList=Array.isArray(s)?s:r.isDefined(s)?[s]:[l.linear],t.cycle=1,t.value=e[1],t.initialValue=i,t.steps=t.stepList[0],t.interval=t.intervalList[0],t.easing=t.easingList[0],t.step=0,t.cycles=0},h.assignSingleTarget=function(t,e,i,n,a,r,s){delete t.valueList,delete t.stepList,delete t.intervalList,delete t.easingList,t.initialValue=i,t.value=e,t.steps=n||0,t.cycles=a||0,t.interval=r||0,t.easing=s},h.snapActualToTarget=function(t,e){var i=t.actualValues[e],n=t.targetValues[e].value;t.actualValues[e]="function"==typeof n?n.call(t):n,t.setActualValueLastUpdate(e),u.handleValueChange(t,e,t.actualValues[e],i,0,0)},h.resolveTargetValue=function(t,e){var i=!t.targetValues[e]&&r.isDefined(t.targets[e].initialValue)?t.targets[e].initialValue:void 0,n=u.getValueStepsCycles(t,e),a=n[0],s=n[1]||0,o=n[2]||0,l=n[3]||0,d=t.targetValues[e]||u.emptyValue(),c=d.value;t.targetValues[e]=d;var g=r.isDefined(t.targets[e].easing)?t.targets[e].easing:void 0;u.isListTarget(a)?h.assignListTarget(d,a.list,a.list[0],s,o,g):(h.assignSingleTarget(d,a,i,s,l,o,g),s>0&&r.areEqual(c,a,!!t.targets[e]&&!!t.targets[e].deepEquality)&&t.resetTargetStep(e))},d.prototype.reset=function(){var t,e;return"BI"===this.tmodel.type?(t=this.tmodel.getX()+this.tmodel.getScrollLeft(),e=this.tmodel.getY()+this.tmodel.getScrollTop(),this.xOffset=0,this.yOffset=0,this.xNext=t,this.xNorth=t,this.xEast=t,this.xSouth=t,this.xWest=t,this.xOverflow=this.tmodel.getRealParent().getX(),this.yNext=e,this.yNorth=e,this.yWest=e,this.yEast=e,this.ySouth=this.tmodel.getRealParent().viewport?this.tmodel.getRealParent().viewport.ySouth:e):(this.xOffset=0,this.yOffset=0,t=this.tmodel.getX(),e=this.tmodel.getY(),this.xNext=t,this.xNorth=t,this.xEast=t,this.xSouth=t,this.xWest=t,this.xOverflow=r.isDefined(this.tmodel.val("xOverflow"))?this.tmodel.val("xOverflow"):t,this.yNext=e,this.yNorth=e,this.yWest=e,this.yEast=e,this.ySouth=e),this},d.prototype.setCurrentChild=function(t){this.currentChild=t,this.xOffset=t.getDomParent()?-t.getDomParent().getX():0,this.yOffset=t.getDomParent()?-t.getDomParent().getY():0},d.prototype.getXNext=function(){return this.xNext+this.currentChild.getLeftMargin()+this.xOffset-this.tmodel.getScrollLeft()},d.prototype.getYNext=function(){return this.yNext+this.currentChild.getTopMargin()+this.yOffset-this.tmodel.getScrollTop()},d.prototype.isVisible=function(t){var e=t.absX,i=t.absY,n=(t.getDomParent()?t.getDomParent().getMeasuringScale():1)*t.getMeasuringScale(),a=r.isDefined(t.getWidth())?n*t.getWidth():0,s=r.isDefined(t.getHeight())?n*t.getHeight():0,o=t.visibilityStatus,l=t.getBoundingRect();return t.hasChildren()?(o.right=e<=l.right,o.left=e+a>=l.left,o.bottom=i<=l.bottom,o.top=i+s>=l.top):(o.right=e<=D()&&e<=l.right,o.left=e+a>=0&&e+a>=l.left,o.bottom=i<=x()&&i<=l.bottom,o.top=i+s>=0&&i+s>=l.top),t.visible=o.left&&o.right&&o.top&&o.bottom,t.isVisible()},d.prototype.isOverflow=function(t,e){if(r.isNumber(t)&&r.isNumber(e))return t>e},d.prototype.overflow=function(){this.xNext=this.xOverflow,this.yNext=this.ySouth},d.prototype.appendNewLine=function(){var t=this.currentChild.getInnerHeight()*this.currentChild.getMeasuringScale();this.xNext=this.xOverflow,this.yNext=this.ySouth>this.yNext?this.ySouth+this.currentChild.val("appendNewLine"):this.ySouth+t+this.currentChild.val("appendNewLine"),this.yEast=this.yNext,this.xSouth=this.xNext,this.ySouth=Math.max(this.yNext,this.ySouth),this.currentChild.getRealParent().viewport.xEast=Math.max(this.currentChild.getRealParent().viewport.xEast,this.xEast),this.currentChild.getRealParent().viewport.ySouth=Math.max(this.currentChild.getRealParent().viewport.ySouth,this.ySouth)},d.prototype.nextLocation=function(){var t=this.currentChild.getInnerWidth()*this.currentChild.getMeasuringScale(),e=this.currentChild.getInnerHeight()*this.currentChild.getMeasuringScale(),i=this.currentChild.getInnerContentHeight()*this.currentChild.getMeasuringScale(),n=this.yNext+e+this.currentChild.getTopMargin()+this.currentChild.getBottomMargin();this.xNext+=t+this.currentChild.getLeftMargin()+this.currentChild.getRightMargin(),this.yNext+=i,this.xSouth=this.xNext,this.yEast=this.yNext,this.xEast=Math.max(this.xNext,this.xEast),this.ySouth=Math.max(n,this.ySouth),this.currentChild.getRealParent().viewport.xEast=Math.max(this.currentChild.getRealParent().viewport.xEast,this.xEast),this.currentChild.getRealParent().viewport.ySouth=Math.max(this.currentChild.getRealParent().viewport.ySouth,this.ySouth)},d.prototype.calcContentWidthHeight=function(){this.tmodel.contentHeight=this.ySouth-this.yNorth,this.tmodel.innerContentHeight=this.yEast-this.yNorth,this.tmodel.innerContentWidth=this.xSouth-this.xWest,this.tmodel.contentWidth=this.xEast-this.xWest},c.prototype.getParent=function(){return this.parent},c.prototype.getRealParent=function(){return this.parent},c.prototype.getDomParent=function(){return this.actualValues.domParent?this.actualValues.domParent:null},c.prototype.getDomHolder=function(){return this.actualValues.domHolder?this.actualValues.domHolder:this.getDomParent()?this.getDomParent().$dom:a.findParentByTarget(this,"domHolder")?a.findParentByTarget(this,"domHolder").$dom:null},c.prototype.addToStyleTargetList=function(t){u.styleTargetMap[t]&&(t=u.transformMap[t]?"transform":u.dimMap[t]?"dim":t,this.styleTargetMap[t]||(this.styleTargetList.push(t),this.styleTargetMap[t]=!0))},c.prototype.bug=function(){return[{visible:this.isVisible()},{visibilityStatus:this.visibilityStatus},{hasDom:this.hasDom()},{x:this.getX()},{y:this.getY()},{width:this.getWidth()},{height:this.getHeight()},{activeTargetList:this.activeTargetList},{updatingTargetList:this.updatingTargetList},{styleTargetList:this.styleTargetList},{children:this.getChildren()},{targetValues:this.targetValues},{actualValues:this.actualValues}]},c.prototype.initTargets=function(){var t=this;this.targetValues={},this.activeTargetMap={},this.activeTargetList=[],Object.keys(this.targets).forEach((function(e){u.bindTargetName(t.targets,e),t.addToActiveTargets(e)}))},c.prototype.hasDomHolderChanged=function(){return this.getDomHolder()&&this.getDomHolder().exists()&&this.$dom.parent().getAttribute("id")!==this.getDomHolder().attr("id")},c.prototype.hasDom=function(){return!!this.$dom&&this.$dom.exists()},c.prototype.hasChildren=function(){return this.getChildren().length>0},c.prototype.getChildren=function(){var t=this.getActualValueLastUpdate("allChildren"),e=this.getActualValueLastUpdate("children"),i=this.getActualValueLastUpdate("addedChildren");if(!t||e>=t||i>=t){var n=this.actualValues.children,a=this.actualValues.addedChildren;if(this.actualValues.allChildren=[].concat(n,a),n&&n.length>0){var r=this;n.forEach((function(t){t.parent=r})),this.actualValues.allChildren.sort((function(t,e){return!t.canBeBracketed()&&e.canBeBracketed()?-1:1}))}this.targetValues.allChildren?this.setActualValueLastUpdate("allChildren"):this.setTarget("allChildren",this.actualValues.allChildren)}return this.actualValues.allChildren},c.prototype.getAllNestedChildren=function(){var t=[];return function e(i){if(i.hasChildren()){var n=i.getChildren();t=t.concat(n),n.forEach((function(t){e(t)}))}}(this),t},c.prototype.getLastChild=function(){return this.hasChildren()?this.getChildren()[this.getChildren().length-1]:void 0},c.prototype.getFirstChild=function(){return this.hasChildren()?this.getChildren()[0]:void 0},c.prototype.getChild=function(t){return this.hasChildren()?this.getChildren()[t]:void 0},c.prototype.getChildIndex=function(t){return this.getChildren().indexOf(t)},c.prototype.getChildrenOids=function(){return this.getChildren().oids()},c.prototype.filterChildren=function(t){return this.getChildren().filter((function(e){return Array.isArray(t)?t.includes(e.type):"function"==typeof t?t.call(e):e.type===t}))},c.prototype.findChild=function(t){return this.getChildren().find((function(e){return"function"==typeof t?t.call(e):e.type===t}))},c.prototype.findLastChild=function(t){return this.getChildren().findLast((function(e){return"function"==typeof t?t.call(e):e.type===t}))},c.prototype.getParentValue=function(t){var e=a.findParentByTarget(this,t);return e?e.val(t):void 0},c.prototype.getGlobalValue=function(t){var e=a.findByTarget(t);return e?e.val(t):void 0},c.prototype.getGlobalValueByType=function(t,e){var i=a.findByType(t);return i?i.val(e):void 0},c.prototype.getContentHeight=function(){return this.contentHeight},c.prototype.getInnerContentHeight=function(){return 0},c.prototype.getInnerHeight=function(){return r.isDefined(this.actualValues.innerHeight)?this.actualValues.innerHeight:this.getHeight()},c.prototype.getInnerWidth=function(){return r.isDefined(this.actualValues.innerWidth)?this.actualValues.innerWidth:this.getWidth()},c.prototype.getInnerXEast=function(){return this.absX+this.getInnerWidth()},c.prototype.getOuterXEast=function(){return this.absX+this.getInnerWidth()},c.prototype.getContentWidth=function(){return this.contentWidth},c.prototype.getUIDepth=function(){for(var t=0,e=this.parent;e;)t++,e=e.parent;return t},c.prototype.resetVisibleList=function(){this.inFlowVisibles.length=0},c.prototype.addToParentVisibleList=function(){this.isVisible()&&this.isInFlow()&&this.getParent()&&this.getParent().inFlowVisibles.push(this)},c.prototype.isVisible=function(){return r.isDefined(this.actualValues.isVisible)?this.actualValues.isVisible:this.visible},c.prototype.shouldCalculateChildren=function(){return r.isDefined(this.actualValues.calculateChildren)?this.actualValues.calculateChildren:this.isVisible()&&this.isIncluded()&&(this.hasChildren()||this.getContentHeight()>0)},c.prototype.createViewport=function(){return this.viewport=this.viewport?this.viewport.reset():new d(this),this.viewport},c.prototype.setLocation=function(t){this.x=t.getXNext(),this.y=t.getYNext()},c.prototype.calculateAbsolutePosition=function(t,e){var i=this.getBoundingRect();this.absX=i.left+t,this.absY=i.top+e},c.prototype.getBoundingRect=function(){return r.getBoundingRect(this)},c.prototype.isMarkedDeleted=function(){return!0===this.val("tmodelDeletedFlag")},c.prototype.markAsDeleted=function(){this.val("tmodelDeletedFlag",!0),this.getChildren().forEach((function(t){t.markAsDeleted()}))},c.prototype.isTextOnly=function(){return this.actualValues.textOnly},c.prototype.getHtml=function(){return this.actualValues.html},c.prototype.isInFlow=function(){return this.actualValues.isInFlow},c.prototype.canHandleEvents=function(){return this.actualValues.canHandleEvents},c.prototype.keepEventDefault=function(){return this.actualValues.keepEventDefault},c.prototype.canBeBracketed=function(){return this.actualValues.canBeBracketed},c.prototype.isIncluded=function(){return this.actualValues.isIncluded},c.prototype.canHaveDom=function(){return this.actualValues.canHaveDom},c.prototype.isDomDeletable=function(){return this.actualValues.isDomDeletable},c.prototype.getOpacity=function(){return this.actualValues.opacity},c.prototype.getX=function(){return this.actualValues.x},c.prototype.getY=function(){return this.actualValues.y},c.prototype.getZIndex=function(){return this.actualValues.zIndex},c.prototype.getScale=function(){return this.actualValues.scale},c.prototype.getMeasuringScale=function(){return this.actualValues.scale},c.prototype.getTopMargin=function(){return this.actualValues.topMargin},c.prototype.getLeftMargin=function(){return this.actualValues.leftMargin},c.prototype.getRightMargin=function(){return this.actualValues.rightMargin},c.prototype.getBottomMargin=function(){return this.actualValues.bottomMargin},c.prototype.getRotate=function(){return this.actualValues.rotate},c.prototype.getWidth=function(){return this.actualValues.width},c.prototype.getHeight=function(){return this.actualValues.height},c.prototype.getScrollTop=function(){return Math.floor(this.actualValues.scrollTop)},c.prototype.getScrollLeft=function(){return Math.floor(this.actualValues.scrollLeft)},c.prototype.getCss=function(){return this.actualValues.css.indexOf("tgt")>=0?this.actualValues.css:this.actualValues.css?"tgt "+this.actualValues.css:"tgt"},c.prototype.getStyle=function(){return this.actualValues.style},c.prototype.getScaledWidth=function(){return this.getWidth()*this.getScale()},c.prototype.getScaledHeight=function(){return this.getHeight()*this.getScale()},c.prototype.getTargetStepPercent=function(t,e){var i=this.getTargetSteps(t);return e=r.isDefined(e)?e:this.getTargetStep(t),i?e/i:1},c.prototype.resetTargetStep=function(t){return this.targetValues[t]&&(this.targetValues[t].step=0),this},c.prototype.resetTargetExecutionCount=function(t){return this.targetValues[t]&&(this.targetValues[t].executionCount=0),this},c.prototype.resetTargetCycle=function(t){return this.targetValues[t]&&(this.targetValues[t].cycle=0),this},c.prototype.resetScheduleTimeStamp=function(t){return this.targetValues[t]&&(this.targetValues[t].scheduleTimeStamp=void 0),this},c.prototype.resetTargetInitialValue=function(t){return this.targetValues[t]&&(this.targetValues[t].initialValue=void 0),this},c.prototype.updateTargetStatus=function(t){var e=this.targetValues[t];if(e){var n=this.getTargetCycle(t),a=this.getTargetCycles(t),r=this.getTargetStep(t),s=this.getTargetSteps(t);this.isExecuted(t)&&r<s||Array.isArray(e.valueList)&&n<e.valueList.length-1?this.targetValues[t].status="updating":!this.isExecuted(t)||this.isTargetInLoop(t)||n<a?this.targetValues[t].status="active":this.targetValues[t].status="done";var o=this.getParent();return this.isTargetUpdating(t)?(this.addToUpdatingTargets(t),this.removeFromActiveTargets(t),o&&o.addToUpdatingChildren(this)):this.isTargetActive(t)?(this.addToActiveTargets(t),this.removeFromUpdatingTargets(t),o&&0===this.updatingTargetList.length&&o.removeFromUpdatingChildren(this)):(this.removeFromActiveTargets(t),this.removeFromUpdatingTargets(t),o&&0===this.updatingTargetList.length&&o.removeFromUpdatingChildren(this),i.manager.doneTargets.push({tmodel:this,key:t})),this.targetValues[t].status}},c.prototype.getTargetStatus=function(t){return this.targetValues[t]?this.targetValues[t].status:""},c.prototype.isTargetActive=function(t){return this.targetValues[t]&&"active"===this.targetValues[t].status},c.prototype.isTargetUpdating=function(t){return this.targetValues[t]&&"updating"===this.targetValues[t].status},c.prototype.isTargetDone=function(t){return this.targetValues[t]&&"done"===this.targetValues[t].status},c.prototype.isTargetComplete=function(t){return this.targetValues[t]&&"complete"===this.targetValues[t].status},c.prototype.isExecuted=function(t){return this.targetValues[t]&&this.targetValues[t].executionCount>0},c.prototype.isTargetImperative=function(t){return!!this.targetValues[t]&&this.targetValues[t].isImperative},c.prototype.getTargetExecutionCount=function(t){return this.targetValues[t]?this.targetValues[t].executionCount:0},c.prototype.setTargetComplete=function(t){this.targetValues[t]&&(this.targetValues[t].status="complete")},c.prototype.isTargetEnabled=function(t){if(this.isTargetImperative(t))return!0;var e=this.targets[t];return!!r.isDefined(e)&&("function"!=typeof e.enabledOn||e.enabledOn.call(this))},c.prototype.isTargetInLoop=function(t){return!!this.targets[t]&&("function"==typeof this.targets[t].loop?this.targets[t].loop.call(this,t):this.targets[t].loop)},c.prototype.doesTargetEqualActual=function(t){if(this.targetValues[t]){var e=!!this.targets[t]&&this.targets[t].deepEquality;return e?r.areEqual(this.getTargetValue(t),this.val(t),e):this.getTargetValue(t)===this.val(t)}return!1},c.prototype.getTargetValue=function(t){return this.targetValues[t]?"function"==typeof this.targetValues[t].value?this.targetValues[t].value.call(this):this.targetValues[t].value:void 0},c.prototype.getTargetSteps=function(t){return this.targetValues[t]&&this.targetValues[t].steps||0},c.prototype.getTargetStep=function(t){return this.targetValues[t]?this.targetValues[t].step:0},c.prototype.getScheduleTimeStamp=function(t){return this.targetValues[t]?this.targetValues[t].scheduleTimeStamp:void 0},c.prototype.getTargetInitialValue=function(t){return this.targetValues[t]?this.targetValues[t].initialValue:void 0},c.prototype.getActualValueLastUpdate=function(t){return this.targetValues[t]?this.targetValues[t].actualValueLastUpdate:void 0},c.prototype.getTargetCreationTime=function(t){return this.targetValues[t]?this.targetValues[t].creationTime:void 0},c.prototype.setTargetStep=function(t,e){return this.targetValues[t]&&(this.targetValues[t].step=e),this.targetValues[t].step},c.prototype.getTargetCycles=function(t){return this.targetValues[t]&&this.targetValues[t].cycles||0},c.prototype.getTargetCycle=function(t){return this.targetValues[t]?this.targetValues[t].cycle:0},c.prototype.setTargetCycle=function(t,e){this.targetValues[t]&&(this.targetValues[t].cycle=e)},c.prototype.setTargetInterval=function(t,e){return this.targetValues[t]&&(this.targetValues[t].interval=e),this.targetValues[t].interval},c.prototype.setScheduleTimeStamp=function(t,e){this.targetValues[t]&&(this.targetValues[t].scheduleTimeStamp=e)},c.prototype.setTargetInitialValue=function(t,e){this.targetValues[t]&&(this.targetValues[t].initialValue=e)},c.prototype.setActualValueLastUpdate=function(t){this.targetValues[t]&&(this.targetValues[t].actualValueLastUpdate=n.now())},c.prototype.getTargetEasing=function(t){return"function"==typeof this.targetValues[t].easing?this.targetValues[t].easing:void 0},c.prototype.getTargetInterval=function(t){return this.targetValues[t]?this.targetValues[t].interval:void 0},c.prototype.getTargetEventFunctions=function(t){return this.targetValues[t]?this.targetValues[t].events:void 0},c.prototype.setTarget=function(t,e,i,n,a,r){return r=r||this.key,h.executeImperativeTarget(this,t,e,i,n,a,r),this},c.prototype.val=function(t,e){return 2===arguments.length?(this.actualValues[t]=e,this):this.actualValues[t]},c.prototype.addValue=function(t,e){return this.actualValues[t]+=e,this},c.prototype.multiplyValue=function(t,e){return this.actualValues[t]*=e,this},c.prototype.addChild=function(t,e){var n=this.actualValues.addedChildren;return e=r.isDefined(e)?e:n.length,t.parent=this,e>=n.length?n.push(t):n.splice(e,0,t),this.setActualValueLastUpdate("children"),this.targetValues.addedChildren?this.setActualValueLastUpdate("addedChildren"):this.setTarget("addedChildren",n),i.manager.scheduleRun(10,"addChild-"+this.oid+"-"+t.oid),this},c.prototype.addToUpdatingChildren=function(t){this.updatingChildrenMap[t.oid]||(this.updatingChildrenMap[t.oid]=!0,this.updatingChildrenList.push(t.oid))},c.prototype.removeFromUpdatingChildren=function(t){if(this.updatingChildrenMap[t.oid]){delete this.updatingChildrenMap[t.oid];var e=this.updatingChildrenList.indexOf(t.oid);e>=0&&this.updatingChildrenList.splice(e,1)}},c.prototype.hasUpdatingChildren=function(){return this.updatingChildrenList.length>0},c.prototype.hasTargetUpdates=function(t){return t?!0===this.updatingTargetMap[t]:this.updatingTargetList.length>0},c.prototype.removeTarget=function(t){delete this.targets[t],this.removeFromActiveTargets(t),this.removeFromUpdatingTargets(t),delete this.targetValues[t]},c.prototype.addTarget=function(t,e){this.targets[t]=e,u.bindTargetName(this.targets,t),this.addToActiveTargets(t),this.removeFromUpdatingTargets(t),delete this.targetValues[t],i.manager.scheduleRun(10,"addTarget-"+this.oid+"-"+t)},c.prototype.addTargets=function(t){var e=this;Object.keys(t).forEach((function(i){e.targets[i]=t[i],u.bindTargetName(e.targets,i),e.addToActiveTargets(i),e.removeFromUpdatingTargets(i),delete e.targetValues[i]})),i.manager.scheduleRun(10,"addTargets-"+this.oid)},c.prototype.addToActiveTargets=function(t){this.activeTargetMap[t]||(this.activeTargetMap[t]=!0,"start"===t?this.activeTargetList.unshift("start"):"width"===t||"height"===t?-1!==this.activeTargetList.indexOf("start")?this.activeTargetList.splice(1,0,t):this.activeTargetList.unshift(t):this.activeTargetList.push(t))},c.prototype.removeFromActiveTargets=function(t){if(this.activeTargetMap[t]){delete this.activeTargetMap[t];var e=this.activeTargetList.indexOf(t);e>=0&&this.activeTargetList.splice(e,1)}},c.prototype.addToUpdatingTargets=function(t){this.updatingTargetMap[t]||(this.updatingTargetMap[t]=!0,this.updatingTargetList.push(t))},c.prototype.removeFromUpdatingTargets=function(t){if(this.updatingTargetMap[t]){delete this.updatingTargetMap[t];var e=this.updatingTargetList.indexOf(t);e>=0&&this.updatingTargetList.splice(e,1)}},c.prototype.deleteTargetValue=function(t){delete this.targetValues[t],this.addToActiveTargets(t),this.removeFromUpdatingTargets(t),i.manager.scheduleRun(10,"deleteTargetValue-"+this.oid+"-"+t)},c.prototype.resetImperative=function(t){var e=this.targetValues[t];return e&&(e.isImperative=!1,e.executionCount=0,e.scheduleTimeStamp=void 0,e.step=0,e.cycle=0,e.steps=0,e.cycles=0,e.interval=0),this},c.prototype.resetTarget=function(t){return this.resetTargets([t])},c.prototype.resetTargets=function(t){var e=this;return t.forEach((function(t){var i=e.targetValues[t];i&&(i.executionCount=0,i.scheduleTimeStamp=void 0,i.step=0,i.cycle=0,e.updateTargetStatus(t))})),i.manager.scheduleRun(10,"resetTargets-"+this.oid),this},c.prototype.setTargetMethodName=function(t,e){this.targetMethodMap[t]||(this.targetMethodMap[t]=[]),-1===this.targetMethodMap[t].indexOf(e)&&this.targetMethodMap[t].push(e)},g.prototype.removeHandlers=function(t){var e=this;this.domEvents.forEach((function(i){t.detachEvent(i,e.bindedHandleEvent)}))},g.prototype.addHandlers=function(t){var e=this;this.domEvents.forEach((function(i){t.addEvent(i,e.bindedHandleEvent)}))},g.prototype.removeWindowHandlers=function(){var t=this;this.windowEvents.forEach((function(e){i.$window.detachEvent(e,t.bindedHandleEvent)}))},g.prototype.addWindowHandlers=function(){var t=this;this.windowEvents.forEach((function(e){i.$window.addEvent(e,t.bindedHandleEvent)}))},g.prototype.captureEvents=function(){if(0===this.eventQueue.length)return this.currentEvent="",void(this.currentKey="");var t=this.eventQueue.shift();"resize"===t.eventName?i.dim.measureScreen():(t.tmodel&&this.findEventHandlers(t.tmodel),this.currentEvent=t.eventName,this.currentKey=this.currentTouch.key,this.currentTouch.key=""),i.manager.scheduleRun(10,"captureEvents-"+t)},g.prototype.handleEvent=function(t){if(t){var e,a,r,s,o=t.type,l=this.eventMap[o];l&&(e=l.to,a=l.inputType,r=l.eventType,s=l.order);var u=n.now();this.touchTimeStamp=u>this.touchTimeStamp?u:this.touchTimeStamp;var h=this.getTModelFromEvent(t),d=this.eventQueue.length>0?this.eventQueue[this.eventQueue.length-1]:null;if(d){var c=d.eventItem,g=u-d.timeStamp;if(a&&c.inputType&&c.inputType!==a&&s>c.order)return;if(this.eventQueue.length>10&&g<50){var p,f=0;for(p=this.eventQueue.length-1;p>=0&&this.eventQueue[p].eventItem.eventType===r;p--)if(++f>5)return}}switch(this.eventQueue.push({eventName:e,eventItem:l,originalName:o,tmodel:h,timeStamp:u}),e){case"mousedown":case"touchstart":this.clearStart(),this.clearTouch(),this.touchCount=this.countTouches(t),this.preventDefault(h,e)&&t.preventDefault(),this.start0=this.getTouch(t),this.start1=this.getTouch(t,1),this.cursor.x=this.start0.x,this.cursor.y=this.start0.y,t.stopPropagation();break;case"mousemove":case"touchmove":var m=this.getTouch(t);this.cursor.x=m.x,this.cursor.y=m.y,this.preventDefault(h,e)&&t.preventDefault(),this.touchCount>0&&(this.move(t),t.stopPropagation());break;case"mouseup":case"touchend":if(this.preventDefault(h,e)&&t.preventDefault(),this.end(t),this.start0){var y=0,v=0,T=u-this.start0.timeStamp;this.end0&&(y=Math.abs(this.end0.originalX-this.start0.originalX),v=Math.abs(this.end0.originalY-this.start0.originalY),T=Math.abs(this.end0.timeStamp-this.start0.timeStamp)),y<=1&&v<=1&&T<=300&&this.eventQueue.push({eventName:"click",eventItem:l,originalName:o,tmodel:h,timeStamp:u})}this.clearStart(),this.touchCount=0,t.stopPropagation();break;case"wheel":this.preventDefault(h,e)&&t.preventDefault(),this.wheel(t);break;case"key":this.currentTouch.key=t.which||t.keyCode}i.manager.scheduleRun(0,o+"-"+e+"-"+(t.target.tagName||"").toUpperCase())}},g.prototype.findEventHandlers=function(t){var e=t?a.findFirstTouchHandler(t):null,i=this.end0?this.currentHandlers.scrollLeft:t?a.findFirstScrollLeftHandler(t):null,n=this.end0?this.currentHandlers.scrollTop:t?a.findFirstScrollTopHandler(t):null,r=t?a.findFirstPinchHandler(t):null;this.currentHandlers.scrollLeft===i&&this.currentHandlers.scrollTop===n||this.clearTouch(),this.currentHandlers.touch=e,this.currentHandlers.scrollLeft=i,this.currentHandlers.scrollTop=n,this.currentHandlers.pinch=r},g.prototype.preventDefault=function(t,e){return!t||!(!0===t.keepEventDefault()||Array.isArray(t.keepEventDefault())&&t.keepEventDefault().includes(e))},g.prototype.getTModelFromEvent=function(t){var e="function"==typeof t.target.getAttribute?t.target.getAttribute("id"):"";return e&&i.manager.visibleOidMap[e]||(e=s.findNearestParentWithId(t.target)),i.manager.visibleOidMap[e]},g.prototype.clearStart=function(){this.start0=void 0,this.start1=void 0,this.end0=void 0,this.end1=void 0,this.touchCount=0},g.prototype.clearTouch=function(){this.currentTouch.deltaY=0,this.currentTouch.deltaX=0,this.currentTouch.pinchDelta=0,this.currentTouch.manualMomentumFlag=!1,this.currentTouch.dir="",this.currentTouch.orientation="none",this.currentTouch.key="",this.currentTouch.source=""},g.prototype.clearAll=function(){this.clearStart(),this.clearTouch(),this.eventQueue.length=0,this.touchTimeStamp=0},g.prototype.resetEventsOnTimeout=function(){if(this.touchTimeStamp>0){var t=n.now()-this.touchTimeStamp,e=0;Math.abs(this.currentTouch.deltaY)>.001||Math.abs(this.currentTouch.deltaX)>.001||Math.abs(this.currentTouch.pinchDelta)>.001?t>70?(this.currentTouch.deltaY=0,this.currentTouch.deltaX=0,this.currentTouch.source="",this.currentTouch.pinchDelta=0):this.currentTouch.manualMomentumFlag&&(this.currentTouch.deltaY*=.85,this.currentTouch.deltaX*=.85,this.currentTouch.source="",e=10):t>600&&(this.clearTouch(),this.touchTimeStamp=0),i.manager.scheduleRun(e,"scroll decay")}},g.prototype.deltaX=function(){return this.currentTouch.deltaX},g.prototype.deltaY=function(){return this.currentTouch.deltaY},g.prototype.pinchDelta=function(){return this.currentTouch.pinchDelta},g.prototype.dir=function(){return this.currentTouch.dir},g.prototype.getScrollLeftHandler=function(){return this.currentHandlers.scrollLeft},g.prototype.getScrollTopHandler=function(){return this.currentHandlers.scrollTop},g.prototype.getPinchHandler=function(){return this.currentHandlers.pinch},g.prototype.getTouchHandler=function(){return this.currentHandlers.touch},g.prototype.getTouchHandlerType=function(){return this.currentHandlers.touch?this.currentHandlers.touch.type:null},g.prototype.getTouchHandlerOid=function(){return this.currentHandlers.touch?this.currentHandlers.touch.oid:null},g.prototype.isClickEvent=function(){return"click"===this.currentEvent},g.prototype.isResizeEvent=function(){return"resize"===this.currentEvent},g.prototype.getCurrentEvent=function(){return this.currentEvent},g.prototype.isClickHandler=function(t){return this.getTouchHandler()===t&&this.isClickEvent()},g.prototype.isClickHandlerType=function(t){return this.getTouchHandlerType()===t&&this.isClickEvent()},g.prototype.isTouchHandler=function(t){return this.getTouchHandler()===t},g.prototype.isScrollLeftHandler=function(t){return this.currentHandlers.scrollLeft===t},g.prototype.isScrollTopHandler=function(t){return this.currentHandlers.scrollTop===t},g.prototype.isPinchHandler=function(t){return this.currentHandlers.pinch===t},g.prototype.isCurrentSource=function(t){return this.currentTouch.source===t},g.prototype.isTouchHandlerType=function(t){return this.getTouchHandlerType()===t},g.prototype.isTouchHandlerOrAncestor=function(t){for(var e=this.getTouchHandler();e;){if(e===t)return!0;e=e.getParent()}return!1},g.prototype.countTouches=function(t){return t.touches&&t.touches.length?t.touches.length:t.originalEvent&&t.originalEvent.touches&&t.originalEvent.touches.length?t.originalEvent.touches.length:1},g.prototype.getTouch=function(t,e){e=e||0;var i=t.touches&&t.touches[e]?t.touches[e]:t.originalEvent&&t.originalEvent.touches&&t.originalEvent.touches[e]?t.originalEvent.touches[e]:t,a=r.isDefined(i.clientX)?i.clientX:i.pageX||0,s=r.isDefined(i.clientY)?i.clientY:i.pageY||0;return{x:a,y:s,originalX:a,originalY:s,target:i.target,timeStamp:n.now()}},g.prototype.move=function(t){var e,i;if(1===this.touchCount)this.start0.y=this.end0?this.end0.y:this.start0.y,this.start0.x=this.end0?this.end0.x:this.start0.x,this.end0=this.getTouch(t),this.start1=void 0,this.end1=void 0,r.isDefined(this.end0)&&(e=this.start0.x-this.end0.x,i=this.start0.y-this.end0.y,this.setDeltaXDeltaY(e,i,"touch"));else if(this.touchCount>=2){this.end0=this.getTouch(t),this.end1=this.getTouch(t,1);var n=r.distance(this.start0.x,this.start0.y,this.start1.x,this.start1.y),a=r.distance(this.end0.x,this.end0.y,this.end1.x,this.end1.y)-n;this.currentTouch.pinchDelta=a>0?.3:a<0?-.3:0}},g.prototype.end=function(){if(this.touchCount<=1&&this.start0){var t,e=0,i=0,a=0;this.end0&&(e=this.start0.x-this.end0.x,i=this.start0.y-this.end0.y,a=this.end0.timeStamp-this.start0.timeStamp),"horizontal"===this.currentTouch.orientation&&Math.abs(e)>1?(t=r.momentum(0,e,a),this.currentTouch.deltaX=t.distance,this.currentTouch.manualMomentumFlag=!0,this.touchTimeStamp=n.now()+t.duration):"vertical"===this.currentTouch.orientation&&Math.abs(i)>1&&(t=r.momentum(0,i,a),this.currentTouch.deltaY=t.distance,this.currentTouch.manualMomentumFlag=!0,this.touchTimeStamp=n.now()+t.duration)}},g.prototype.setDeltaXDeltaY=function(t,e,i){var n=Math.abs(t)-Math.abs(e);n>=1?("none"===this.currentTouch.orientation||"vertical"===this.currentTouch.orientation&&n>3||"horizontal"===this.currentTouch.orientation)&&(this.currentTouch.orientation="horizontal",this.currentTouch.dir=t<=-1?"left":t>=1?"right":this.currentTouch.dir,this.currentTouch.source=i,this.currentTouch.deltaX=t,this.currentTouch.deltaY=0):"none"===this.currentTouch.orientation||"horizontal"===this.currentTouch.orientation&&n<-3||"vertical"===this.currentTouch.orientation?(this.currentTouch.orientation="vertical",this.currentTouch.dir=e<=-1?"up":e>=1?"down":this.currentTouch.dir,this.currentTouch.source=i,this.currentTouch.deltaY=e,this.currentTouch.deltaX=0):(this.currentTouch.deltaY=0,this.currentTouch.deltaX=0)},g.prototype.wheel=function(t){var e=0,i=0;this.currentTouch.pinchDelta=0,this.start0=this.getTouch(t),t.ctrlKey&&"deltaY"in t?this.currentTouch.pinchDelta=-t.deltaY/10:"deltaX"in t?(e=t.deltaX,i=t.deltaY):"wheelDeltaX"in t?(e=-t.wheelDeltaX/120,i=-t.wheelDeltaY/120):"wheelDelta"in t?e=-t.wheelDelta/120:"detail"in t&&(e=t.detail/3),this.setDeltaXDeltaY(e,i,"wheel")},p.prototype.initSingleLoad=function(t,e,i){this.isLoading(t)||this.isLoaded(t)&&!i||this.getLoadingAttempts(t)>this.stopLoadingAfterAttempts||(this.initLoadingMap(t),this.singleLoadList=this.singleLoadList?this.singleLoadList:{},this.singleLoadList[t]={fetchId:t,query:e})},p.prototype.initGroupLoad=function(t,e,i,n,a){var r=JSON.stringify({query:i,idKey:n,separator:a});this.isLoading(t)||this.isLoaded(t)||this.getLoadingAttempts(t)>this.stopLoadingAfterAttempts||(this.initLoadingMap(t),this.groupLoadList=this.groupLoadList?this.groupLoadList:{},this.groupLoadList[r]||(this.groupLoadList[r]=[]),this.groupLoadList[r].push({fetchId:t,dataId:e}))},p.prototype.initImgLoad=function(t,e){this.isLoading(t)||this.isLoaded(t)||this.getLoadingAttempts(t)>this.stopLoadingAfterAttempts||(this.initLoadingMap(t,"image"),this.imgLoadList=this.imgLoadList?this.imgLoadList:{},this.imgLoadList[t]={fetchId:t,src:e})},p.prototype.isLoading=function(t){return!!r.isDefined(this.loadingMap[t])&&this.loadingMap[t].loadingFlag},p.prototype.isLoaded=function(t){return r.isDefined(this.resultMap[t])&&!0===this.resultMap[t].success},p.prototype.getLoadingAttempts=function(t){return r.isDefined(this.loadingMap[t])?this.loadingMap[t].attempts:0},p.prototype.getSuccessLoadingTime=function(t){return r.isDefined(this.loadingMap[t])&&!0===this.loadingMap[t].success?this.loadingMap[t].loadingTime:void 0},p.prototype.getFailedInterval=function(t){return r.isDefined(this.loadingMap[t])?this.loadingMap[t].attempts*this.attemptFailedInterval:0},p.prototype.fetchResult=function(t){return this.resultMap[t]},p.prototype.hasLoadedSuccessfully=function(t){return this.resultMap[t]&&!0===this.resultMap[t].success},p.prototype.hasLoadedUnsuccessfully=function(t){return this.resultMap[t]&&!1===this.resultMap[t].success},p.prototype.fetchErrors=function(t){return this.resultMap[t]&&this.resultMap[t].result&&this.resultMap[t].result.errors?this.resultMap[t].result.errors:void 0},p.prototype.initLoadingMap=function(t,e){e=e||this.getCategoryFromFetchId(t),r.isDefined(this.loadingMap[t])?(this.loadingMap[t].loadingFlag=!0,this.loadingMap[t].startTime=n.now(),this.loadingMap[t].loadingTime=void 0):this.loadingMap[t]={fetchId:t,category:e,loadingFlag:!0,attempts:0,startTime:n.now(),loadingTime:void 0,success:!1}},p.prototype.groupLoad=function(){if(this.groupLoadList){for(var t=Object.keys(this.groupLoadList),e=0;e<t.length;e++){for(var i=t[e],n=this.groupLoadList[i],a=[],r={},s=0;s<n.length;s++){var o=n[s].dataId;a.push(o),r[o]=n[s].fetchId}if(a.length>0){var l=JSON.parse(i),u=this.updateQueryValue(l.query,a.join(l.separator));this.groupAjax(u,r,l.idKey)}delete this.groupLoadList[i]}this.groupLoadList=void 0}},p.prototype.singleLoad=function(){if(this.singleLoadList){for(var t=Object.keys(this.singleLoadList),e=0;e<t.length;e++){var i=this.singleLoadList[t[e]];this.singleAjax(i.query,i.fetchId)}this.singleLoadList=void 0}},p.prototype.imgLoad=function(){if(this.imgLoadList){for(var t=Object.keys(this.imgLoadList),e=0;e<t.length;e++){var i=this.imgLoadList[t[e]];this.imgAjax(i.src,i.fetchId)}this.imgLoadList=void 0}},p.prototype.updateQueryValue=function(t,e){for(var i in t)"%s"===t[i]?t[i]=e:"%d"===t[i]?t[i]="number"==typeof e?e:parseFloat(e):"object"==typeof t[i]&&this.updateQueryValue(t[i],e);return t},p.prototype.singleAjax=function(t,e){var a=this,r={dataType:"json",type:"GET",success:function(t){a.loadingMap[e].loadingFlag=!1,a.loadingMap[e].loadingTime=n.now()-a.loadingMap[e].startTime,a.loadingMap[e].success=!0,a.loadingMap[e].attempts++,a.resultMap[e]=Object.assign({result:t},a.loadingMap[e]),delete a.loadingMap[e],a.updateStatistics(e),i.manager.scheduleRun(0,"singleAjax_success_"+e)},error:function(t){a.resultMap[e]={error:t,success:!1},a.loadingMap[e].loadingFlag=!1,a.loadingMap[e].loadingTime=n.now()-a.loadingMap[e].startTime,a.loadingMap[e].attempts++,i.manager.scheduleRun(0,"singleAjax_error_"+e)}};s.ajax(Object.assign(r,t))},p.prototype.groupAjax=function(t,e,a){var r=this,o={dataType:"json",type:"GET",success:function(s){for(var o=0;o<s.length;o++){var l=s[o][a];if(e[l]){var u=e[l];r.loadingMap[u].loadingFlag=!1,r.loadingMap[u].loadingTime=n.now()-r.loadingMap[u].startTime,r.loadingMap[u].success=!0,r.loadingMap[u].attempts++,r.resultMap[u]=Object.assign({result:s[o]},r.loadingMap[u]),r.updateStatistics(u),delete r.loadingMap[u],delete e[l]}}Object.keys(e).forEach((function(t){var i=e[t];r.loadingMap[i].success||(r.loadingMap[i].loadingFlag=!1,r.loadingMap[i].loadingTime=n.now()-r.loadingMap[i].startTime,r.loadingMap[i].attempts++)})),i.manager.scheduleRun(0,"groupAjax_success_"+t)},error:function(n){Object.keys(e).forEach((function(t){var i=e[t];r.resultMap[i]={error:n,success:!1},r.loadingMap[i].loadingFlag=!1,r.loadingMap[i].attempts++})),i.manager.scheduleRun(0,"groupAjax_error_"+t)}};s.ajax(Object.assign(o,t))},p.prototype.imgAjax=function(t,e){var a=this,r=new Image;r.src=t,r.onload=function(){a.loadingMap[e].loadingFlag=!1,a.loadingMap[e].loadingTime=n.now()-a.loadingMap[e].startTime,a.loadingMap[e].success=!0,a.loadingMap[e].attempts++,a.resultMap[e]=Object.assign({width:this.width,height:this.height,$image:new s(r)},a.loadingMap[e]),a.updateStatistics(e,"image"),delete a.loadingMap[e],i.manager.scheduleRun(0,"imgAjax_success_"+e)},r.onerror=r.onabort=function(){a.resultMap[e]={result:"no image",success:!1},a.loadingMap[e].loadingFlag=!1,a.loadingMap[e].loadingTime=n.now()-a.loadingMap[e].startTime,a.loadingMap[e].attempts++,i.manager.scheduleRun(0,"imgAjax_error_"+e)}},p.prototype.getCategoryFromFetchId=function(t){return t.replace(/[^a-zA-Z]/g,"")},p.prototype.updateStatistics=function(t,e){e=e||this.getCategoryFromFetchId(t),this.statistics[e]?(this.statistics[e].count++,this.statistics[e].totalTime+=this.resultMap[t].loadingTime,this.statistics[e].lastUpdate=n.now(),delete this.statistics[e].averageTime):this.statistics[e]={count:1,totalTime:this.resultMap[t].loadingTime,lastUpdate:n.now()}},p.prototype.getAverageLoadingTime=function(t){var e=n.now();if(this.statistics[t]&&this.statistics[t].averageTime&&e-this.statistics[t].lastUpdate<500)return this.statistics[t].averageTime;var i=this.statistics[t]?this.statistics[t].totalTime:0,a=this.statistics[t]?this.statistics[t].count:0;return Object.values(this.loadingMap).filter((function(e){return e.category===t})).forEach((function(t){i+=e-t.startTime,a++})),this.statistics[t]?(this.statistics[t].averageTime=a>0?i/a:0,this.statistics[t].lastUpdate=n.now(),this.statistics[t].averageTime):0},f.bracketMap={},f.bracketAllMap={},f.generate=function(t,e){var n=f.bracketMap[t.oid],a=Math.max(t.getActualValueLastUpdate("allChildren"),t.getActualValueLastUpdate("width"),t.getActualValueLastUpdate("height"));if(n&&n.lastUpdate>=a)n=f.bracketMap[t.oid];else{n={lastUpdate:a,list:[]};for(var r=(e="BI"===t.type||e?e:t.getChildren()).length,s=Math.max(2,i.locationManager.bracketThreshold-1),o=!1,l=0,u=0,h=0;h<r;h++){var d=h-u;if(e[h].canBeBracketed()&&(d===s||h===r-1)||!e[h].canBeBracketed()&&d>0){var c=e[h].canBeBracketed()?h+1:h;n.list.push(f.createBracket(t,e,u,c)),u=h+1,l++}l>s&&(o=!0),e[h].canBeBracketed()||(l=0,n.list.push(e[h]),u=h+1)}o?n=f.generate(t,n.list):f.bracketMap[t.oid]=n}return n},f.createBracket=function(t,e,i,n){var a,r=t.oid+"_"+t.getWidth()+"_"+t.getHeight()+"_"+e.slice(i,n).oids("_");return f.bracketAllMap[r]?a=f.bracketAllMap[r]:(a=new f(t),f.bracketAllMap[r]=a,a.actualValues.tchildren=e.slice(i,n),"BI"===a.actualValues.tchildren[0].type&&a.actualValues.children.forEach((function(t){t.bracketParent=a})),a.bracketParent=t),a},m.prototype.calculateAll=function(){this.hasLocationList.length=0,this.hasLocationMap={},this.locationCount.length=0,this.startTime=n.now(),this.resizeFlag=!1,this.screenWidth===D()&&this.screenHeight===x()||(this.resizeFlag=!0,this.screenWidth=D(),this.screenHeight=x()),this.calculate()},m.prototype.calculate=function(){this.addToLocationList(i.troot),this.calculateContainer(i.troot)},m.prototype.getChildren=function(t){var e;return this.isProlificContainer(t)&&(e=f.generate(t)),e?e.list:t.getChildren()},m.prototype.isProlificContainer=function(t){return t.canBeBracketed()&&t.getChildren().length>this.bracketThreshold},m.prototype.calculateContainer=function(t){var e=this.getChildren(t),a=t.createViewport();t.resetVisibleList();for(var s=0,o=e.length;s<o&&i.isRunning();){var l=e[s++];if(l){var u,d,c=l.domValues.x,g=l.domValues.y;this.calculateTargets(l),l.getActualValueLastUpdate("canBeBracketed")>l.getParent().getActualValueLastUpdate("allChildren")&&delete l.getParent().targetValues.allChildren,a.setCurrentChild(l),l.setLocation(a),l.calculateAbsolutePosition(l.x,l.y),d=r.isDefined(t.val("innerXEast"))?t.val("innerXEast"):t.getInnerXEast(),u=r.isDefined(l.val("outerXEast"))?l.val("outerXEast"):l.getOuterXEast(),a.isOverflow(u,d)?(a.overflow(),l.setLocation(a)):l.setLocation(a),l.isIncluded()&&!this.hasLocationMap[l.oid]&&this.addToLocationList(l),!l.isTargetEnabled("x")||l.isTargetUpdating("x")||l.isTargetImperative("x")||0!==l.getTargetSteps("x")?r.isDefined(l.targetValues.x)||l.val("x",l.x):(h.resolveTargetValue(l,"x"),h.snapActualToTarget(l,"x")),!l.isTargetEnabled("y")||l.isTargetUpdating("y")||l.isTargetImperative("y")||0!==l.getTargetSteps("y")?r.isDefined(l.targetValues.y)||l.val("y",l.y):(h.resolveTargetValue(l,"y"),h.snapActualToTarget(l,"y")),c===l.getX()&&g===l.getY()||l.addToStyleTargetList("transform"),l.calculateAbsolutePosition(l.getX(),l.getY()),a.isVisible(l),l.addToParentVisibleList(),l.shouldCalculateChildren()&&this.calculateContainer(l),l.isInFlow()&&(r.isNumber(l.val("appendNewLine"))?(a.appendNewLine(),a.calcContentWidthHeight()):(a.calcContentWidthHeight(),a.nextLocation())),Array.isArray(l.val("contentHeight"))&&l.val("contentHeight").forEach((function(t){var e=l.val(t);l.val(t,l.getContentHeight()),e!==l.val(t)&&l.addToStyleTargetList(t)})),Array.isArray(l.val("contentWidth"))&&l.val("contentWidth").forEach((function(t){var e=l.val(t);l.val(t,l.getContentWidth()),e!==l.val(t)&&l.addToStyleTargetList(t)})),a.calcContentWidthHeight(),this.locationCount.push(l.oid+"-"+l.updatingTargetList.length+"-"+(n.now()-this.startTime))}}},m.prototype.calculateTargets=function(t){if(this.resetTargetsOnEvents(t),i.targetManager.applyTargetValues(t),i.targetManager.setActualValues(t),t.hasDom()){var e=t.getWidth(),n=t.getHeight();(r.isDefined(t.targetValues.width)||r.isDefined(t.targets.width)||r.isDefined(t.targetValues.contentWidth))&&!t.getTargetValue("widthFromDom")||u.setWidthFromDom(t),(r.isDefined(t.targetValues.height)||r.isDefined(t.targets.height)||r.isDefined(t.targetValues.contentHeight))&&!t.getTargetValue("heightFromDom")||u.setHeightFromDom(t),e===t.getWidth()&&n===t.getHeight()||t.addToStyleTargetList("dim")}},m.prototype.resetTargetsOnEvents=function(t){var e=[];this.resizeFlag&&t.targets.onResize&&(e=e.concat(t.targets.onResize)),M().isTouchHandler(t)&&t.targets.onTouchEvent&&(e=e.concat(t.targets.onTouchEvent)),M().isClickHandler(t)&&t.targets.onClickEvent&&(e=e.concat(t.targets.onClickEvent)),(M().isScrollLeftHandler(t)&&M().deltaX()||M().isScrollTopHandler(t)&&M().deltaY())&&t.targets.onScrollEvent&&(e=e.concat(t.targets.onScrollEvent)),TargetJ.getEvents().currentKey&&t.targets.onKeyEvent&&(e=e.concat(t.targets.onKeyEvent)),e.forEach((function(e){var i,n;"object"==typeof e?(i=e.key,n=e.object||t):(i=e,n=t),n.targets[i]&&n.isTargetComplete(i)&&n.resetTarget(i)}))},m.prototype.addToLocationList=function(t){this.hasLocationList.push(t),this.hasLocationMap[t.oid]=t},y.prototype.openPage=function(t){i.stop(),i.reset();var e=this;this.pageCache[t]?(i.troot=this.pageCache[t].troot,i.troot.getChildren().forEach((function(i,n){i.$dom.innerHTML(e.pageCache[t].htmls[n])})),r.initDoms(this.pageCache[t].visibleList),i.manager.lists.visible=this.pageCache[t].visibleList.slice(0),e.lastLink=t,setTimeout(i.start)):(i.troot.getChildren().forEach((function(t){t.$dom.innerHTML("")})),i.troot=i.trootFactory(),e.lastLink=t,setTimeout(i.start))},y.prototype.openLinkFromHistory=function(t){t.link?this.openPage(t.link):t.browserUrl&&(history.replaceState({link:t.browserUrl},"",t.browserUrl),this.openPage(t.browserUrl)),i.manager.scheduleRun(0,"pagemanager-openLinkFromHistory")},y.prototype.openLink=function(t){t=r.getFullLink(t),this.lastLink&&(this.pageCache[this.lastLink]={link:this.lastLink,htmls:i.troot.getChildren().map((function(t){return t.$dom.innerHTML()})),visibleList:i.manager.lists.visible.slice(0),troot:i.troot}),history.pushState({link:t},"",t),this.openPage(t),i.manager.scheduleRun(0,"pagemanager-processOpenLink")},y.prototype.updateBrowserUrl=function(t){window.history.state.browserUrl?history.replaceState({browserUrl:t},"",t):(this.pageCache[document.URL]={link:document.URL,htmls:i.troot.getChildren().map((function(t){return t.$dom.innerHTML()})),visibleList:i.manager.lists.visible.slice(0),troot:i.troot},history.pushState({browserUrl:t},"",t)),i.manager.scheduleRun(0,"pagemanager-processUpdateBrowserUrl")},y.prototype.back=function(){return history.back()},v.prototype.init=function(){this.lists={visible:[],rerender:[],restyle:[],reattach:[],invisibleDom:[],deletedTModel:[],visibleNoDom:[],updatingTModels:[],updatingTargets:[],activeTargets:[]},this.visibleTypeMap={},this.visibleOidMap={},this.targetMethodMap={},this.doneTargets=[],this.nextRuns=[],this.runningStep=0,this.runningFlag=!1,this.rerunOid="",this.cycleStats={duration:0,count:0,totalDuration:0,average:0}},v.prototype.resetRuns=function(){this.nextRuns=[],this.runningStep=0,this.runningFlag=!1,this.rerunOid=""},v.prototype.resetCycle=function(){this.cycleStats.duration=0,this.cycleStats.count=0,this.cycleStats.totalDuration=0,this.cycleStats.average=0},v.prototype.clear=function(){this.lists.visible.length=0,this.lists.rerender.length=0,this.lists.restyle.length=0,this.lists.reattach.length=0,this.lists.visibleNoDom.length=0,this.lists.updatingTModels.length=0,this.lists.updatingTargets.length=0,this.lists.activeTargets.length=0,this.visibleTypeMap={},this.visibleOidMap={},this.targetMethodMap={}},v.prototype.visibles=function(t,e){return e=e||this.lists.visible,this.lists.visible.filter((function(e){return e.type===t||!t})).map((function(t){return t.oid}))},v.prototype.findVisible=function(t){return this.lists.visible.find((function(e){return e.type===t}))},v.prototype.findLastVisible=function(t){return this.lists.visible.findLast((function(e){return e.type===t}))},v.prototype.analyze=function(){var t,e,n=r.list2map(this.lists.visible);for(this.clear(),t=0;t<i.locationManager.hasLocationList.length;t++){var a=(e=i.locationManager.hasLocationList[t]).isVisible();if(e.isMarkedDeleted()&&-1===this.lists.deletedTModel.indexOf(e))this.lists.deletedTModel=[].concat(this.lists.deletedTModel,e,e.getAllNestedChildren()),n[e.oid]=null;else if(a){n[e.oid]=null,e.hasDom()&&!e.canHaveDom()&&-1===this.lists.invisibleDom.indexOf(e)&&this.lists.invisibleDom.push(e),this.lists.visible.push(e),this.needsRerender(e),this.needsRestyle(e),this.needsReattach(e),e.updatingTargetList.length>0&&(this.lists.updatingTModels.push(e),this.lists.updatingTargets=this.lists.updatingTargets.concat(e.updatingTargetList));var s=Object.keys(e.activeTargetMap);s.length>0&&(this.lists.activeTargets=this.lists.activeTargets.concat("'"+e.oid+"'",s)),Object.keys(e.targetMethodMap).length>0&&(this.targetMethodMap[e.oid]=Object.assign({},e.targetMethodMap)),this.visibleOidMap[e.oid]=e,this.visibleTypeMap[e.type]||(this.visibleTypeMap[e.type]=[]),this.visibleTypeMap[e.type].push(e),e.canHaveDom()&&!e.hasDom()&&e.getDomHolder()&&e.getDomHolder().exists()&&-1===this.lists.visibleNoDom.indexOf(e)&&this.lists.visibleNoDom.push(e)}}var o=Object.values(n).filter((function(t){return null!==t&&t.hasDom()&&t.isDomDeletable()}));o.forEach((function(t){i.manager.lists.invisibleDom.push(t)}))},v.prototype.needsRerender=function(t){return!(!t.hasDom()||!r.isDefined(t.getHtml())||t.$dom.html()===t.getHtml()&&t.$dom.textOnly===t.isTextOnly()||(this.lists.rerender.push(t),0))},v.prototype.needsRestyle=function(t){return!!(t.hasDom()&&t.styleTargetList.length>0)&&(this.lists.restyle.push(t),!0)},v.prototype.needsReattach=function(t){return!(!t.hasDom()||!t.hasDomHolderChanged()||(this.lists.reattach.push(t),0))},v.prototype.renderTModels=function(){var t,e;for(t=0;t<this.lists.rerender.length;t++)(e=this.lists.rerender[t]).isTextOnly()?e.$dom.text(e.getHtml()):e.$dom.html(e.getHtml()),e.setActualValueLastUpdate("html"),e.domHeight=void 0,e.domWidth=void 0},v.prototype.reattachTModels=function(){var t,e;for(t=0;t<this.lists.reattach.length;t++)(e=this.lists.reattach[t]).$dom.detach(),e.getDomHolder().appendTModel$Dom(e)},v.prototype.deleteDoms=function(){var t;for(t=0;t<this.lists.invisibleDom.length;t++){var e=this.lists.invisibleDom[t];e.domValues={};var i=[].concat(e.targets.resetOnInvisible,e.targets.onResize);i&&i.forEach((function(t){e.targets[t]&&e.isTargetComplete(t)&&e.resetTarget(t)})),e.$dom.detach(),e.$dom=null}for(t=0;t<this.lists.deletedTModel.length;t++)this.removeTModel(this.lists.deletedTModel[t]);var n=this.lists.invisibleDom.length>0||this.lists.deletedTModel.length>0;this.lists.invisibleDom.length=0,this.lists.deletedTModel.length=0,n&&this.scheduleRun(0,"deleteDoms")},v.prototype.removeTModel=function(t){t.markAsDeleted();var e,i=t.getParent();i&&i.hasChildren()&&(i.removeFromUpdatingChildren(t),(e=i.val("children").indexOf(t))>=0&&(i.val("children").splice(e,1),i.setActualValueLastUpdate("children")),(e=i.val("addedChildren").indexOf(t))>=0&&(i.val("addedChildren").splice(e,1),i.setActualValueLastUpdate("addedChildren")),i.setActualValueLastUpdate("allChildren")),t.$dom&&(t.$dom.detach(),t.$dom=null)},v.prototype.fixStyles=function(){var t,e;for(t=0;t<this.lists.restyle.length;t++)(e=this.lists.restyle[t]).styleTargetList.forEach((function(t){switch(t){case"transform":var i=Math.floor(e.getX()),n=Math.floor(e.getY()),a=Math.floor(e.getRotate()),s=r.formatNum(e.getScale(),2);e.domValues.x===i&&e.domValues.y===n&&e.domValues.rotate===a&&e.domValues.scale===s||(e.$dom.transform(i,n,a,s),e.domValues.y=n,e.domValues.x=i,e.domValues.rotate=a,e.domValues.scale=s);break;case"dim":var o=Math.floor(e.getWidth()),l=Math.floor(e.getHeight());e.$dom.width()===o&&e.$dom.height()===l||(e.$dom.width(o),e.$dom.height(l));break;case"style":var u=e.getStyle();r.isDefined(u)&&e.domValues.style!==u&&(e.$dom.setStyleByMap(e.getStyle()),e.domValues.style=u);break;case"css":var h=e.getCss();e.$dom.css()!==h&&e.$dom.css(h);break;case"borderRadius":case"padding":case"lineHeight":case"fontSize":r.isDefined(e.val(t))&&e.domValues[t]!==e.val(t)&&(e.$dom.style(t,r.isNumber(e.val(t))?e.val(t)+"px":e.val(t)),e.domValues[t]=e.val(t));break;default:r.isDefined(e.val(t))&&e.domValues[t]!==e.val(t)&&(e.$dom.style(t,e.val(t)),e.domValues[t]=e.val(t))}})),e.styleTargetMap={},e.styleTargetList.length=0},v.prototype.completeDoneTModels=function(){i.manager.doneTargets.forEach((function(t){var e=t.tmodel,i=t.key;e.isTargetDone(i)&&(e.setTargetComplete(i),e.removeFromActiveTargets(e),e.removeFromUpdatingTargets(e),e.getParent()&&0===e.updatingTargetList.length&&e.getParent().removeFromUpdatingChildren(e))}))},v.prototype.createDoms=function(){var t,e,n,a=[],o=[];for(this.lists.visibleNoDom.sort((function(t,e){return t.hasChildren()&&e.hasChildren()?t.getUIDepth()<e.getUIDepth()?-1:1:t.hasChildren()?-1:1})),t=0;t<this.lists.visibleNoDom.length;t++)n=this.lists.visibleNoDom[t],s.query("#"+n.oid)?(e=new s("#"+n.oid),n.$dom=e):o.push(n);for(t=0;t<o.length;t++){n=o[t];var l=Math.floor(n.getX()),u=Math.floor(n.getY()),h=Math.floor(n.getRotate()),d=r.formatNum(n.getScale(),2),c=Math.floor(n.getWidth()),g=Math.floor(n.getHeight()),p=Math.floor(n.getZIndex()),f={position:"absolute",top:0,left:0,transform:[l,u,h,d],width:c+"px",height:g+"px",opacity:n.getOpacity()?n.getOpacity().toFixed(2):0,zIndex:p};["fontSize","borderRadius","padding","lineHeight"].forEach((function(t){var e=n.val(t);e&&(f[t]=r.isNumber(e)?e+"px":e)})),["backgroundColor","background","color"].forEach((function(t){var e=n.val(t);e&&(f[t]=e)})),Object.assign(f,n.getStyle()),(e=new s).create("div"),e.setSelector("#"+n.oid),e.setId(n.oid),e.css(n.getCss()),e.setStyleByMap(f),n.domValues={},n.domValues.x=l,n.domValues.y=u,n.domValues.rotate=h,n.domValues.scale=d,n.domValues.style=f,n.$dom=e;var m=a.find((function(t){return t.domHolder===n.getDomHolder()}));m?m.tmodels.push(n):a.push({domHolder:n.getDomHolder(),tmodels:[n]})}a.map((function(t){t.tmodels.map((function(e){t.domHolder.appendTModel$Dom(e)}))})),a.length&&i.manager.scheduleRun(1,"createDom")},v.prototype.scheduleRun=function(t,e){if(t<1&&0===i.throttle)i.manager.run(e,t);else{var a=n.delay((function(){i.manager.run(e,t)}),e,0===i.throttle?t||0:i.throttle),r=this.nextRuns.length>0?this.nextRuns[this.nextRuns.length-1]:null;a&&(!r||a.delay>r.delay)?this.nextRuns.push(a):a&&r&&a.delay<=r.delay&&i.manager.runningFlag&&(i.manager.rerunOid=e)}},v.prototype.run=function(t,e){i.isRunning()?i.manager.runningFlag?i.manager.rerunOid=t:(i.manager.runningFlag=!0,window.requestAnimationFrame((function(){for(var a=i.manager.runningStep,r=n.now();n.now()-r<25&&i.manager.runningStep<7&&i.isRunning();){switch(i.manager.runningStep){case 0:i.events.captureEvents(),i.manager.doneTargets.length>0&&(i.manager.completeDoneTModels(),i.manager.doneTargets.length=0),i.locationManager.calculateTargets(i.troot),i.locationManager.calculateAll(),i.events.resetEventsOnTimeout();break;case 1:i.manager.analyze();break;case 2:i.manager.createDoms();break;case 3:i.manager.renderTModels(),i.manager.reattachTModels();break;case 4:i.manager.fixStyles();break;case 5:i.manager.deleteDoms();break;case 6:i.loader.singleLoad(),i.loader.groupLoad(),i.loader.imgLoad()}i.manager.runningStep++}var s=n.now()-r;if(i.manager.cycleStats.duration=0===a?s:i.manager.cycleStats.duration+s,i.debugLevel>0&&(n.log(i.debugLevel>0&&i.manager.cycleStats.duration>10)("it took: "+i.manager.cycleStats.duration+", "+t),n.log(i.debugLevel>0&&i.manager.cycleStats.duration>10)("count: "+i.locationManager.locationCount),n.log(i.debugLevel>1)("request from: "+t+" delay:  "+e)),i.manager.runningFlag=!1,7!==i.manager.runningStep)i.manager.run("rendering: "+t+" "+i.manager.runningStep);else if(i.manager.cycleStats.count++,i.manager.cycleStats.totalDuration+=i.manager.cycleStats.duration,i.manager.cycleStats.average=i.manager.cycleStats.totalDuration/i.manager.cycleStats.count,i.manager.rerunOid){i.manager.runningStep=0;var o=i.manager.rerunOid;i.manager.rerunOid="",i.manager.run(o)}else i.manager.runningStep=0,i.manager.getNextRun()}))):this.getNextRun()},v.prototype.getNextRun=function(){if(this.nextRuns.length>0&&i.isRunning()){var t=this.nextRuns.pop();t&&i.manager.scheduleRun(t.timeStamp-n.now(),t.oid)}},T.prototype.applyTargetValues=function(t){t.targetMethodMap={};for(var e=t.activeTargetList.slice(0),i=0;i<e.length;i++){var n=e[i];t.isTargetImperative(n)||this.applyTargetValue(t,n)}},T.prototype.applyTargetValue=function(t,e){var n=t.targets[e];if(r.isDefined(n))if(t.targetValues[e]||!r.isDefined(t.targets[e].initialValue)||r.isDefined(t.actualValues[e])||(t.actualValues[e]=t.targets[e].initialValue),"function"==typeof n.enabledOn&&t.setTargetMethodName(e,"enabledOn"),t.isTargetEnabled(e)){if(!(t.getTargetStep(e)===t.getTargetSteps(e)&&u.scheduleExecution(t,e)>0)){t.resetScheduleTimeStamp(e),t.isExecuted(e)&&t.getTargetCycle(e)<t.getTargetCycles(e)&&(t.setTargetCycle(e,t.getTargetCycle(e)+1),t.resetTargetStep(e),t.resetTargetInitialValue(e)),h.executeDeclarativeTarget(t,e);var a=u.scheduleExecution(t,e);a>0&&i.manager.scheduleRun(a,"actualInterval__"+t.oid+"__"+e)}}else i.manager.scheduleRun(10,"applyTargetValue-disabled-"+t.oid+"__"+e);else t.removeFromActiveTargets(e)},T.prototype.setActualValues=function(t){var e,i,n=t.updatingTargetList.slice(0);for(e=0;e<n.length;e++)i=n[e],0===u.scheduleExecution(t,i)&&(t.addToStyleTargetList(i),this.setActualValue(t,i))},T.prototype.setActualValue=function(t,e){var n=t.targetValues[e];if(n)if(t.isTargetEnabled(e)){var s,o,l,d=t.getTargetValue(e),c=t.getTargetStep(e),g=t.getTargetSteps(e),p=t.getTargetCycle(e),f=t.getTargetInterval(e)||0,m=t.actualValues[e],y=c,v=p,T=t.getTargetInitialValue(e);if(c<=g&&(r.isDefined(T)||(T=t.actualValues[e],t.setTargetInitialValue(e,T)),t.actualValues[e]=u.morph(t,e,T,d,c,g),t.setActualValueLastUpdate(e),t.isTargetImperative(e)?(s=n.originalTargetName,l=t,(o=t.targets[n.originalTargetName])||(o=(l=a.findParentByTarget(t,s)).targets[n.originalTargetName]),o&&"function"==typeof o.onImperativeStep&&(o.onImperativeStep.call(l,e,l.actualValues[e],c,g),l.setTargetMethodName(s,"onImperativeStep"))):u.handleValueChange(t,e,t.actualValues[e],m,y,v),t.setTargetStep(e,c+1),t.resetScheduleTimeStamp(e),t.updateTargetStatus(e),t.isTargetUpdating(e)))i.manager.scheduleRun(f,t.oid+"---"+e+"-"+c+"/"+g+"-"+p+"-"+f);else{t.actualValues[e]=d,t.setActualValueLastUpdate(e),c=t.getTargetStep(e);var b=0;n.valueList&&p<n.valueList.length-1?(t.setTargetCycle(e,t.getTargetCycle(e)+1),p=t.getTargetCycle(e),t.resetTargetStep(e),n.initialValue=n.value,n.value=n.valueList[p],n.steps=n.stepList[(p-1)%n.stepList.length],n.interval=n.intervalList[(p-1)%n.intervalList.length],n.easing=n.easingList[(p-1)%n.easingList.length],b=f):t.isTargetImperative(e)?(s=n.originalTargetName,l=t,(o=t.targets[n.originalTargetName])||(o=(l=a.findParentByTarget(t,s)).targets[n.originalTargetName]),o&&"function"==typeof o.onImperativeStep&&(o.onImperativeStep.call(l,e,l.actualValues[e],c,g),l.setTargetMethodName(s,"onImperativeStep")),o&&"function"==typeof o.onImperativeEnd&&(o.onImperativeEnd.call(l,e,l.actualValues[e]),l.setTargetMethodName(s,"onImperativeEnd"))):(t.getTargetCycle(e)<t.getTargetCycles(e)&&(t.setTargetCycle(e,t.getTargetCycle(e)+1),t.resetTargetStep(e).resetTargetInitialValue(e).resetTargetExecutionCount(e),h.executeDeclarativeTarget(t,e)),"object"==typeof t.targets[e]&&"function"==typeof t.targets[e].onStepsEnd&&(t.targets[e].onStepsEnd.call(t,p),t.setTargetMethodName(e,"onStepsEnd"))),t.updateTargetStatus(e),i.manager.scheduleRun(b,t.oid+"---"+e+"-"+c+"/"+g+"-"+p+"-"+f)}}else i.manager.scheduleRun(10,"setActualValue-disabled-"+t.oid+"__"+e)},window.t=window.t||a.find,b.oids={},b.getOid=function(t){r.isDefined(b.oids[t])||(b.oids[t]=0);var e=b.oids[t]++;return{oid:e>0?t+e:t,num:e}},E.bounce=function(t,e,i){for(var n=e*(i=i||.6),a=[t];(0|n)>1;)a.push(e),a.push(e-n),n*=.5;return a},E.spiral=function(t,e,i,n,a,r,s){for(var o=[],l=[],u=[],h=t;h<=e;h+=i){var d=h*(Math.PI/180);o.push(Math.floor(n+r*Math.cos(d))),l.push(Math.floor(a+s*Math.sin(d))),u.push(90+h)}return{x:o,y:l,rotate:u}},window.TargetJ=e})();